\title{DIOPHANTINE ANALYSIS AND MODULAR FUNCTIONS}
\markright{Diophantine Analysis and Modular Functions}

\author{By~~ B. J. Birch}

\date{}

\maketitle

\setcounter{pageoriginal}{34}
\noindent
{\bf 1.}~\textsc{In}\pageoriginale 1952, Heegner published a paper \cite{art03-key5} in which he discussed certain curves parametrised by modular functions. By evaluating the modular functions at certain points, he showed that these curves had points whose coordinates were integers of certain class-fields. Unfortunately, the style of his proofs was unconvincing, so his paper has been discounted; none the less, his main assertions appear correct and interesting.

In particular, if $E$ is an elliptic curve over the rationals $\bfQ$, parametrised by modular functions, there are well-known conjectures (see Appendix) about the group $E_{\bfQ}$ of rational points of $E$. At the expense of being rather special, we can be very explicit; take $E$ in Weierstrass form
$$
E:y^{2}=x^{3}+Ax+B,\quad A, B \text{~ integers;}
$$
and write $E_{K}$ for the group of points of $E$ with coordinates in a field $K$. If $K$ is a number field, $E_{K}$ is finitely generated; write $g(E_{K})$ for the number of independent generators of infinite order. Let $D$ be an integer, and $E^{(-D)}$ the curve ${}-Dy^{2}=x^{3}+Ax+B$; then $g(E_{\bfQ(\surd-D)})=g(E_{\bfQ})+g(E_{\bfQ}^{(-D)})$. The conjectures assert that, for fixed $A$, $B$, the parity of $g(E_{\bfQ(\surd-D)})$ and so of $g(E_{\bfQ}^{(-D)})$ depend on the sign of $D$ and the congruence class of $D$ modulo a power of $6(4A^{3}+27B^{2})$. Heegner's paper seems at present the only hope of approaching such conjectures - at any rate, it provides infinitely many cases for which they are true.

I will give two illustrations of Heegner's argument. The best known assertion in his paper is the enumeration of the complex quadratic fields of class number 1: the complex quadratic field of discriminant $D$ has class number 1 if and only if $D=3,4,7,8,11,19,43,67,163$. Subsequently, the first accepted proof of this has been given by Stark \cite{art03-key7}, and Baker \cite{art03-key1} has given another approach. I\pageoriginale will give a proof, essentially the same as Heegner's; on the way, I will re-prove and extend classical results of Weber \cite{art03-key9} on `class invariants'. Afterwards, I will exhibit a family of curves related to $H/\Gamma_{0}(17)$, each of which have infinitely many rational points.

The theory of complex multiplication can of course be built up algebraically \cite{art03-key3}. Though I will be using function theory, because it is traditional and probably easier, all the constructions are basically algebraic; in particular, we have an algebraic solution of the class number 1 problem.

\medskip
\noindent
{\bf 2.}~From now on, $p$ will always be a prime $p\equiv 3(4)$, $p>3$. $j(z)$ is the modular function, defined for $z$ in the open upper half plane $H$, invariant by the modular group $\Gamma(1)$, and mapping $i$, $\rho$, $i\infty$ to 1728, 0, $\infty$; note that $j(\frac{1}{2}+it)$ is real and negative for real $t>\surd 3/2$. $\Gamma(N)$ is the subgroup of $\Gamma(1)$ consisting of maps $z\to \dfrac{az+b}{cz+d}$ with $\left(\begin{smallmatrix} a & b\\ c & d\end{smallmatrix}\right)\equiv \left(\begin{smallmatrix} 1 & 0\\ 0 & 1\end{smallmatrix}\right)(N)$.

If $\omega$ is quadratic over $\bfQ$, then $A\omega^{2}+B\omega+C=0$, with $A$, $B$, $C$ integers without common factor; define $D(\omega)=|B^{2}-4AC|$. Call $D$ a field discriminant if $D$ is the absolute value of the discriminant of complex quadratic field; so either $D\equiv 3(4)$ and $D$ is square free, or $\frac{1}{4}D\equiv 1$, $2(4)$ and $\frac{1}{4}D$ is square free.

I quote the standard theorems about the value of a modular function $f(\omega)$ at a complex quadratic value $\omega$. For proofs of Theorems 1 and 2, see \cite{art03-key3}.

\begin{theorem}\label{art03-thm1}
If $D(\omega)$ is a filed discriminant, then $j(\omega)$ is an algebraic integer and generates the class field $K_{1}$ of $\bfQ(\omega)$ over $\bfQ(\omega)$.
\end{theorem}

\begin{theorem}\label{art03-thm2}
If $D(\omega)=M^{2}D_{1}$ with $M$ integral and $D_{1}$ a field discriminant, then $j(\omega)$ generates the ring class field $K_{M}$ modulo $M$ of $\bfQ(\omega)$ over $\bfQ(\omega)$.
\end{theorem}

\begin{theorem}[S\"ohngen \cite{art03-key6}]\label{art03-thm3}
Suppose that $f(z)$ is invariant by $\Gamma(N)$, and the Fourier expansions of $f$ at every cusp of $H/\Gamma(N)$ have coefficients\pageoriginale in $\bfQ({}^{N}\surd 1)$. If $D(\omega)=M^{2}D_{1}$ as above, then $f(\omega)\in K'_{MN}$, the ray class field modulo $MN$ of $\bfQ(\omega)$.
\end{theorem}

\begin{coro*}
$\bfQ(\omega,f(\omega))$ is an abelian extension of $\bfQ(\omega)$.
\end{coro*}

Now we set $\omega=\frac{1}{2}(1+\surd-p)$, where $p$ is still a prime $\equiv 3(4)$, so $D(\omega)=p$. Then $K_{1}=\bfQ(\omega,j(\omega))$ is the class filed of $\bfQ(\omega)$, and $j(\omega)$ is a negative real algebraic integer.

We know that $[K_{1}:\bfQ(\omega)]$ is odd. The $K_{M}/\bfQ(\omega)$ norms of {\em integral} ideals of $K_{M}$ prime to $M$ are precisely the principal ideals $(\alpha)$ where $\alpha$ is an integer of $\bfQ(\omega)$ congruent modulo $M$ to a rational integer prime to $M$. Accordingly, we see easily that
\begin{align*}
[K_{2}:K_{1}] &= 
\begin{cases}
1 & \text{for~~ } p\equiv 7(8)\\[4pt]
3 & \text{for~~ } p\equiv 3(8),
\end{cases}\\
\text{and}\qquad [K_{3}:K_{1}] &=
\begin{cases}
2 & \text{for~~ } p\equiv 2(3)\\[4pt]
4 & \text{for~~ } p\equiv 1(3).
\end{cases}
\end{align*}
Further, $K'_{2}=K_{2}$ and $K'_{3}=K_{3}$.

All this is very classical, see \cite{art03-key9}, \cite{art03-key6} or \cite{art03-key3}.

\medskip
\noindent
{\bf 3.}~Now let us look at some particular functions.

\setcounter{theorem}{0}
\begin{example}[Wiber \cite{art03-key9} \S125]\label{art03-exam1}
There is a function $\gamma(z)$ invariant by $\Gamma(3)$ with $\gamma^{3}(z)=j(z)$ and $\gamma(z)$ real for $\Rre(z)=\frac{1}{2}$. By Theorem \ref{art03-thm3}, $\gamma(\omega)\in K_{3}$; but $[K_{3}:K_{1}]$ is a power of $2$, and obviously $[K_{1}(\gamma(\omega)):K_{1}]$ is odd; so
\begin{equation}
\gamma(\omega)\in K_{1}.\label{art03-eq1}
\end{equation}
\end{example}

\begin{example}\label{art03-exam2}
There is a function $\sigma(z)$ invariant by $\Gamma(48)$ related to $j(z)$ by
\begin{equation}
(\sigma^{24}(z)-16)^{3}=\sigma^{24}(z)j(z).\label{art03-eq2}
\end{equation}
If $j$ is real and negative, $(U-16)^{3}=U_{j}$ has a unique real root which is positive; if $z=\frac{1}{2}+it$ with $t>\frac{1}{2}\surd 3$, then $\sigma(z)$ is the unique positive real root of \eqref{art03-eq2}. $\sigma^{24}(z)$ is invariant by $\Gamma(2)$, and in fact $\sigma^{24}(\omega)$ generates $K_{2}$ over $K_{1}$. So far, all is well known and in \cite{art03-key9}, though the normalisation is different.
\end{example}

Now\pageoriginale we restrict $p\equiv 3(8)$, so that $[K_{2}:K_{1}]=3$, $\sigma^{24}(\omega)$ is cubic over $K_{1}$. By Theorem \ref{art03-thm3}, $\sigma(\omega)$ is abelian over $K_{1}$, and by \eqref{art03-eq2} and Theorem \ref{art03-thm1}, $\sigma(\omega)$ is an algebraic integer.

I assert that
\begin{equation}
\sigma^{12}(\omega)\in K_{2}.\label{art03-eq3}
\end{equation}

For $\sigma^{12}$ is quadratic over $K_{2}$, and abelian of degree 6 over $K_{1}$, so $\sigma^{12}\in K_{2}(a)$ with $a^{2}\in K_{1}$. Suppose $\sigma^{12}\not\in K_{2}$. Then $\sigma^{24}\in K_{2}$, so $\sigma^{12}=ab$ with $b\in K_{2}$. So $\sigma^{24}=a^{2}b^{2}$. So $2^{12}=N_{K_{2}/K_{1}}(\sigma^{24})=(N_{K_{2}/K_{1}}b)^{2}a^{6}$; so $a=\pm 2^{6}(a^{2}Nb)^{-1}\in K_{1}$. So $\sigma^{12}\in K_{2}$, as required. Also, $N_{K_{2}/K_{1}}(\sigma^{12})>0$, so $N_{K_{2}/K_{1}}(\sigma^{12})=2^{6}$.

Repeat the argument :
\begin{equation}
\sigma^{6}(\omega)\in K_{2}.\label{art03-eq4}
\end{equation}

Repeat it again : $\surd 2 \sigma^{3}(\omega)\in K_{2}$.

This is an old conjecture of Weber (see \cite{art03-key9} \S127); however, for our applications we will use no more than \eqref{art03-eq4}, which was already proved by Weber.

Using our first example, we have $\sigma^{8}(\omega)=(\sigma^{24}(\omega)-16)/\gamma(\omega)\in K_{2}$, so by \eqref{art03-eq4}
\begin{equation}
\sigma^{2}(\omega)\in K_{2}\text{~~ for~~ } p\equiv 3(8).\label{art03-eq5}
\end{equation}

\begin{example}[\cite{art03-key9} \S134]\label{art03-exam3}
There is a function $g(z)$ invariant by $\Gamma(2)$ with $g^{2}=j-1728$; $g(\frac{1}{2}+it)$ must be pure imaginary when $t$ is real, we may take it to have positive imaginary part.

$g(\omega)\in K_{2}$, but $K_{2}$ is an odd extension of $K_{1}$, so $g(\omega)\in K_{1}$ and
\begin{equation}
\surd (-p)g(\omega)\in K_{1}\cap \bfR.\label{art03-eq6}
\end{equation}
\end{example}

\medskip
\noindent
{\bf 4.}~Heegner applies these examples to enumerate the complex quadratic fields with class number 1, and to exhibit infinite families of elliptic curves with non-trivial rational points. In this paragraph, we will restrict $p\equiv 3(8)$; this is enough for the class number 1 problem, as the other cases are easy.

For the moment, suppose $\bfQ(\surd -p)$ has class number 1, so
\begin{equation}
K_{1}=\bfQ(\surd - p).\label{art03-eq7}
\end{equation}
Write\pageoriginale $V=\sigma^{2}(\omega)$. Then $V$ satisfies a cubic equation over $K_{1}$, say
\begin{equation}
V^{3}-\alpha V^{2}+\beta V-2=0;\label{art03-eq8}
\end{equation}
since $V$ is a real algebraic integer, $\alpha$, $\beta$ are real algebraic integers in $K_{1}$; so $\alpha$, $\beta$ are rational integers.

Since the roots of \eqref{art03-eq8} are three of the roots of $V^{12}-\gamma V^{4}-16=0$, the left hand side of \eqref{art03-eq8} divides $(V^{12}-\gamma V^{4}-16)$, so there must be a relation between $\alpha$ and $\beta$; it turns out to be
$$
\beta^{2}-4\beta\alpha^{2}+2\alpha^{4}-2\alpha=0.
$$
So we have reduced \eqref{art03-eq7} to the problem of solving the Diophantine equation $(\beta-2\alpha^{2})^{2}=2\alpha(1+\alpha^{3})$ in integers. This is easy, see \cite{art03-key5}; the complete solution is
\begin{center}
\begin{tabular}{rrrrrrrr}
$\alpha$ & = & 0 & 1 & 1 & ${}-1$ & 2 & 2\,\\[3pt]
$\beta$ & = & 0 & 0 & 4 & 2 & 2 & 14\,\\[3pt]
corresponding to~ $p$ & = & 3 & 11 & 67 & 19 & 43 & 163.
\end{tabular}
\end{center}
This is a complete enumeration of complex quadratic fields $\bfQ(\surd-p)$ with class number 1 and $p\equiv 3(8)$.

Now we exhibit some curves with points. By \eqref{art03-eq2},
$$
j-1728=(\sigma^{24}-64)(\sigma^{24}+8)^{2}\sigma^{-24},
$$
so
$$
\sigma^{24}-64=\left(\dfrac{\sigma^{12}g}{\sigma^{24}+8}\right)^{2}.
$$
By \eqref{art03-eq4} and \eqref{art03-eq6}, we deduce that
\begin{equation}
{}-pu^{2}=v^{4}-64\label{art03-eq9}
\end{equation}
is soluble in $K_{2}\cap \bfR$. But $[K_{2}\cap \bfR:\bfQ]$ is odd; so the curve \eqref{art03-eq9} has an odd divisor defined over $\bfQ$ : it clearly has a divisor of order $2$; so \eqref{art03-eq9} is soluble in $\bfQ$. But \eqref{art03-eq9} is a non-trivial 2-covering of the elliptic curve
\begin{equation}
Y^{2}=X(X^{2}+p^{2})\label{art03-eq10}
\end{equation}
which accordingly has infinitely many rational points. (These points have rather large coordinates - indeed, they account for several gaps in the tables of \cite{art03-key2}).

A\pageoriginale similar argument works, with appropriate modifications, when $p\equiv 7(8)$; see \cite{art03-key5}. We have thus confirmed the main conjecture of \cite{art03-key2}, for the particular curves \eqref{art03-eq10} with $p$ a prime congruent to 3 modulo 4; for that conjecture predicts that the group of rational points of \eqref{art03-eq10} should have structure $\bfZ_{2}\times \bfZ$.

\medskip
\noindent
{\bf 5.}~Finally we give another example, using a different method. We consider the subgroup $\Gamma_{0}(17)$ of $\Gamma(1)$ consisting of maps $z\to \dfrac{az+b}{cz+d}$ with $ad-bc=1$, $c\equiv 0(17)$; $w_{17}$ is the map $z\to -\dfrac{1}{17z}$, and $\Gamma^{*}_{0}$ is the group generated by $\Gamma_{0}(17)$ and $w_{17}$. Then $H/\Gamma_{0}(17)$ has genus $1$, with function field generated over $\bfQ$ by $j(\omega)$, $j(17\omega)$; $w_{17}$ is an involution on $H/\Gamma_{0}(17)$, and $H/\Gamma^{*}_{0}$ has genus zero. Suppose $H/\Gamma^{*}_{0}$ is uniformised by $\tau(z)$. Then $\tau(z)\in \bfQ(j(z).j(17z),j(z)+j(17z))$, and if we specialise $z\to \omega$, $\tau(\omega)\in \bfQ(j(\omega),j(17\omega))$. [A priori, there may be finitely many exceptions, corresponding to specialisations which make both the numerator and the denominator vanish.] Now write $k(z)=j(z)-j(17z)$, then $k$ is invariant by $\Gamma_{0}$ but not $\Gamma^{*}_{0}$, $k^{2}$ is invariant by $\Gamma^{*}_{0}$, and $H/\Gamma_{0}(17)$ has equation $k^{2}=G(\tau)$, with $G(X)\in \bfQ(X)$. By a suitable birational transformation (making a bilinear transformation on $\tau$, and replacing $k$ by $\sigma f(\tau)$ with $f(X)\in \bfQ(X)$) we may obtain Fricke's equation $\sigma^{2}=\tau^{4}-6\tau^{3}-27\tau^{2}-28\tau-16$; see \cite{art03-key4}.

As usual, write $E_{\bfQ(\surd -D)}$ for the group of points of the elliptic curve $E:Y^{2}=G(X)$ which have coordinates in $\bfQ(\surd-D)$; the conjectures predict that $E_{\bfQ(\surd-D)}$ should have an odd number of generators of infinite order, and so be infinite, if $D$ is a positive integer congruent to 3 modulo 4 which is a quadratic residue modulo 17.

Suppose then that $p$ is prime, $p\equiv 3(4)$, $\left(\dfrac{p}{17}\right)=+1$. Then we can find $\omega$ with $\Delta(\omega)=p$, $17\omega=1\surd\overline{\omega}$; for, take $\omega$ as a root of $17A\omega^{2}+B\omega+A=0$ where $B^{2}-68A^{2}=-p$. But now $j(17\omega)=j(1\surd\overline{\omega})=j(-\overline{\omega})=\overline{j(\omega)}$, and $j(\omega)\in K_{1}$ the class field of $\bfQ(\surd-p)$. Hence $j(\omega)\cdot j(17\omega)$, $j(\omega)+j(17\omega)$ and so $\tau(\omega)$ are real, and $k(\omega)=j(\omega)-j(17\omega)$ is pure imaginary. We deduce that
$$
\surd (-p)k(\omega),\tau(\omega)\in K_{1}\cap \bfR,
$$\pageoriginale
an extension of $\bfQ$ of odd degree. As in the previous paragraph, ${}-pY^{2}=G(X)$ has a point in $K_{1}\cap \bfR$ and so in $\bfQ$, and this implies that $E_{\bfQ(\surd-p)}$ is infinite (except possibly in finitely many cases).

\medskip
\noindent
{\bf Appendix.}~The so-called Birch-Swinnerton-Dyer conjectures were officially stated in \cite{art03-key2}; since then, they have been extended and generalised in various ways, and nowadays the standard account is \cite{art03-key8}. However, the particular case we are quoting is not mode quite explicit; though it was remarked by Shimura some years ago.

We suppose that $E:y^{2}=x^{3}+Ax+B$ is a `good' elliptic curve with conductor $N$. This means (for motivation, see Weil \cite{art03-key10}), {\em inter alia}, that $E$ is parametrised by functions on $H/\Gamma_{0}(N)$, and corresponds to a differential $f(z)dz=\Sigma a_{n}e^{2\pi inz}dz$ on $H/\Gamma_{0}(N)$; the essential part of the zeta function of $E$ is $L_{E}(s)=\Sigma a_{n}n^{-s}=(2\pi)^{s}(\Gamma(s))^{-1}\int^{\infty}_{0}f(iz)z^{s-1}dz$; and $E$ has a good reduction modulo $p$ precisely when $p$ does not divide $N$, so $N$ divides a power of $6(4 A^{3}+27B^{2})$. The involution $\omega_{N}:z\to -1/Nz$ of $H/\Gamma_{0}(N)$ will take $f(z)dz$ to $\pm f(z)dz$; so $L_{E}(s)$ has a functional equation $\Lambda_{E}(s)=\epsilon N^{1-s}\Lambda_{E}(2-s)$, where $\Lambda_{E}(s)=\Gamma(s)(2\pi)^{-s}L_{E}(s)$ and $\epsilon^{2}=1$. Let $\chi(n)$ be a real character with conductor $M$, with $(M,N)=1$, and $L_{E}(s,\chi)=\Sigma a_{n}\chi(n)n^{-s}$; then $L_{E}(s,\chi)$ has functional equation $\Gamma_{E}(s,\chi)=\epsilon \chi(-N)N^{1-s}\Lambda_{E}(2-s,\chi)$, where $\Lambda_{E}(s,\chi)=(M/2\pi)^{s}\Gamma(s)$. $\Lambda_{E}(2-s,\chi)$. So $L_{E}(s,\chi)$ has a zero at $s=1$ of odd or even order according to the sign of $\chi(-N)$.

Say $D>0$, $D\equiv 3(4)$, $\chi(n)=\left(\dfrac{n}{D}\right)$; then $L_{E}(s,\chi)$ is the essential part of the zeta function of $E^{(-D)}:-Dy^{2}=x^{3}+Ax+B$. The main conjecture of \cite{art03-key2} asserts that $L_{E}(s,\chi)$ should have a zero of order $g(E^{(-D)}_{\bfQ})$ at $s=1$; so the parity of $g(E^{(-D)}_{\bfQ})$ should be determined by the Legendre symbol $\left(\dfrac{-N}{D}\right)$.

Finally, we remark that if $\mathfrak{U}$ is a point of $E_{\bfQ(\surd-D)}$ and $\overline{\mathfrak{U}}$ its conjugate over $\bfQ$, then $\mathfrak{U}+\overline{\mathfrak{U}}\in E_{\bfQ}$ and $\mathfrak{U}-\overline{\mathfrak{U}}$ is a point of $E_{\bfQ(\surd-D)}$ with\pageoriginale $x$ real and $y$ pure imaginary, so $\mathfrak{U}-\overline{\mathfrak{U}}$ gives a point of $E_{\bfQ}^{(-D)}$. Hence $g(E_{\bfQ(\surd-D)})=g(E_{\bfQ})+g(E_{\bfQ}^{(-D)})$, and so forth.

\medskip
\noindent
{\em Added in proof.}~ Since this talk was given, I have heard that Deuring, and Stark, too, have independently decided that Heegner was right after all. Deuring's paper was published in {\em Inventiones Mathematicae} 5 (1968); Stark's has yet to appear.

\begin{thebibliography}{99}
\bibitem{art03-key1} \textsc{A. Baker :} Linear forms in the logarithms of algebraic numbers, {\em Mathematika} 13 (1966), 204-216.

\bibitem{art03-key2} \textsc{B. J. Birch} and \textsc{H. P. F. Swinnerton-Dyer :} Notes on elliptic curves, II, {\em J. f\"ur reine u. angew. Math.} 218 (1965), 79-108.

\bibitem{art03-key3} \textsc{Mas Deuring :} Klassenk\"orper der komplexen Multiplikation, {\em Enzyklop\"adie der Math. Wiss. Bd.} I2, Heft 10, Teil II, 23.

\bibitem{art03-key4} \textsc{R. Fricke :} {\em Lehrbuch der Algebra} III, Braunschweig 1928.

\bibitem{art03-key5} \textsc{Kurt Heegner :} Diophantische Analysis und Modulfunktionen, {\em Math. Zeitschrift} 56 (1952), 227-253.

\bibitem{art03-key6} \textsc{H. S\"ohngen :} Zur komplexen Multiplikation, {\em Math. Annalen} 111 (1935), 302-328.

\bibitem{art03-key7} \textsc{H. M. Stark :} A complete determination of the complex quadratic fields with class-number one, {\em Michigan Math. J.} 14 (1967), 1-27.

\bibitem{art03-key8} \textsc{H. P. F. Swinnerton-Dyer :} The conjectures of Birch and Swinnerton-Dyer, and of Tate, {\em Proc. Conf. Local Fields, Driebergen,} 1966, pp. 132-157. (Pub. Springer).

\bibitem{art03-key9} \textsc{H. Weber :} {\em Lehrbuch der Algebra} III, Braunschweig 1908.

\bibitem{art03-key10} \textsc{A. Weil :} Uber die Bestimmung Dirichletscher Reihen durch Funktionalgleichungen, {\em Math. Annalen} 168 (1967), 149-156.
\end{thebibliography}

\bigskip
\noindent
University of Oxford

\noindent
Oxford, England.


