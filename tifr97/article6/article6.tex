
\title{THE CIRCLE METHOD AND THE FOURIER COEFFICIENTS OF MODULAR FORMS}
\markright{THE CIRCLE METHOD AND THE FOURIER COEFFICIENTS OF MODULAR FORMS}

\author{By~ Henryk Iwaniec}

\date{}
\maketitle

\setcounter{pageoriginal}{46} 

\hfill \textit{To the memory of Srinivasa Ramanujan}

\section{Introduction.}\label{art6-sec1} The\pageoriginale circle method was first used in number theory by G. Hardy and S. Ramanujan \cite{art6-key2} to establish an asymptotic formula for the partition function (see also \cite{art6-key7}) and it was applied extensively in the series of papers under the common title : Some problems of ``Partitio Numerorum'' by G. Hardy and J.E. Littlewood to study additive problems such as the Waring problem or the Goldbach problem (see for example \cite{art6-key1}). The method was particularly interesting for additive problems with many summands. Yet at that time the important results were conditional subject to sharp estimates for the relevant extponential sums.

Perhaps the most ambitious are the binary problems, \ie the problems of evaluating the number of solutions to the equation
$$
a + b = n,
$$
where $a$, $b$ range over finite sets of integers $A$, $B$ respectively and $n$ is a fixed integer. Clearly, the number of solutions is given by the integral (Vinogradov's modification)
$$
\int\limits^1_0 e (-\alpha n) \left(\sum\limits_{a\in A} e (\alpha a) \right) \left(\sum\limits_{b \in B} e(\alpha b) \right) d \alpha. 
$$
The Hardy-Littlewood arguments fail to handle the binary problem for a fundamental reason--the use of Parseval's identity
$$
\int\limits^1_0 |\sum\limits_{a\in A} e(\alpha a)|^2 d \alpha = |A|.
$$
It is evident that when dealing with a binary problem one cannot ignore a cancellation in the integration over any set of positive constant measure. Taking this into account in 1926, H. D. Kloosterman \cite{art6-key4} introduced a brilliant\pageoriginale refinement which is described by Yu. V. Linnik in \cite{art6-key6} as the process of levelling (a sophisticated partition of the segment $0 < \alpha < 1$ by means of Farey's points). Kloosterman's method was originally used for the binary problem in which $a$ and $b$ assume values of some quadratic forms. The important point should be mentioned that the exponential sum
$$
\sum\limits_{a \in A} e(\alpha a)
$$
is evaluated precisely enough to control the oscillatory behaviour of the remainder term which is usually of the order of magnitude $|A|^{1/2}$. Both the partition of the segment $0 < \alpha < 1$ and the nature of the remainder term comprise the appearance of the Kloosterman sums
$$
S (\dot{m}, n: c) = \sum\limits_{d (\mod c)} e\left(\frac{md + n\bar{d}}{c} \right),
$$
where $\sum^\ast$ means that the summation ranges over $d$ prime to $c$ and $\bar{d}$ is the multiplicative inverse to $d(\mod c)$. Then a non-trivial bound for $S(m, n;c)$ yields a cancellation of the remainder terms and consequently one breaks the barrier set by the use of Parseval's identity. The Kloosterman device enables one to handle a large class of binary problems. Moreover it turns out to be successful in answering various questions about the Fourier coefficients of modular forms (see for example \cite{art6-key5}).

Kloosterman did not exploit a cancellation of terms of summation over the moduli $c$ that exists due to the variation of sign of the Kloosterman sum $S(m, n;c)$. In this connection Linnik \cite{art6-key6} was led to formulate the following hypothesis
$$
\sum\limits_{c \leqslant C} c^{-1} S(m, n; c) \ll C^\epsilon
$$
and he said : ``This hypothesis can be considered as a certain analogy to the well-known hypothesis of Hasse on the behaviour of congruence zeta-functions arising by the reduction of a given curve with respect to all prime moduli.'' A somewhat stronger statement was expressed by A. Selberg \cite{art6-key8} in the context of estimating the Fourier coefficients of modular forms. The recent developments in the spectral theory of automorphic functions brought a remarkable progress towards the Linnik-Selberg hypothesis.

If one sequence $A$ or $B$ in the binary problem has no reference to the modular forms, then naturally other exponential sums emerge in place of the\pageoriginale Kloosterman sums. For example see the paper by C. Hooley \cite{art6-key3} in which the Kloosterman refinement is applied to advance in the Waring problem for cubes under the Riemann hypothesis for certain Hasse-Weil L-Functions.

In this paper we elaborate the Kloosterman ideas in a general context. We shall express the distribution
$$
\delta(n) = 
\left\{
\begin{aligned}
& 1 \text{ if } n = 0\\
& 0 \text{ if } n \neq 0 
\end{aligned}
 \right.
$$
in terms of the Ramanujan sums
$$
S(n;c) =\sum\limits^\ast_{d(\mod c)} e \left(n \frac{d}{c} \right)
$$
and of new sums of type
$$
S_v (n; c) = \sum\limits^\ast_{d (\mod c)} \left(\left(\frac{d+v}{c} \right) \right) e \left(n \frac{d}{c} \right),
$$
where $((\zeta)) = \zeta - [\zeta] - 1/2$. We shall establish a formula for the Fourier coefficient of a cusp form in terms of the Kloosterman sums $S(m,n;c)$ and of the new Kloosterman type sums
$$
S_v (m, n;c) = \sum\limits^\ast_{d(\mod c)} \left(\left(\frac{d+v}{c} \right) \right) e \left(\frac{md+n\bar{d}}{c} \right).
$$
These sums are closely related. Indeed, by the Fourier expansion (boundedly convergent)
$$
(\zeta)) = \sum\limits_{0 < |h| < H} (2 \pi i h)^{-1} e (\xi h) + O [(1+ ||\zeta|| H)^{-1},
$$
where $||\zeta||$ is the distance of $\zeta$ to the nearest integer, it follows that
$$
S_v (m, n; c) = \sum\limits_{0 <|h| < H} (2\pi i h)^{-1} e \left(\frac{hv}{c} \right) S (m+h,\; n; c) + O \left(1+ \frac{c \log 2 c}{H} \right).
$$
We expect, but were not able to prove it, that the error term above should be 
$$
O\left[c^\epsilon \left(1+ \frac{c}{H} \right)^{\frac{1}{2}} \right].
$$

\section{A general result.}\label{art6-sec2}
We\pageoriginale begin by considering a periodic function $f(x)$ of period 1 with the aim of evaluating its mean value
$$
\mu (f) = \int\limits^1_0 f (x) dx.
$$
Divide the range of integration by Farey's points of order $C$, \ie by the rational numbers $d/c$ with 
$$
1 \leqslant c \leqslant C, \; 0 \leqslant d < c, \; (d, c) = 1
$$
For $2 \leqslant c \leqslant C$ let $\fM (d/c)$ stand for the interval whose endpoints are Farey's mediants, \ie
$$
\fM \left(\frac{d}{c} \right) = \left[\frac{d+d_-}{c+c_-}, \frac{d+d_+}{c+c_+} \right] = \left[\frac{d}{c} - \frac{1}{c(c+c_-)}, \frac{d}{c} + \frac{1}{c(c+c_+)} \right]
$$
where $d_- /c_- < d/c < d_+/c_+$ are the adjacent points. For $c =1$ we have $d=0$ and we set $c_\mp = C$, $d_\mp = \mp 1$,
$$
\fM \left(\frac{0}{1} \right) = \left[\frac{-1}{C+1} , \frac{1}{C+1} \right].
$$
We obtain 
\begin{align*}
\mu(f) & = \sum\limits_{1 \leqslant c \leqslant C} \sum\limits_{0\leqslant d < c} \int\limits_{\fM_{(d/c)}} f(x)  dx\\
& = \sum\limits_{1\leqslant c \leqslant C} c^{-1} \sum\limits^\ast_{0 \leqslant d < c} \int\limits^{(c+c_+)^{-1}}_{-(c+c_-)^{-1}} f \left(\frac{d+x}{c} \right) dx
\end{align*}
For notational simplicity, put $F(x) = f((d+x)/c)$. We have
\begin{gather*}
\int\limits^{(c+c_+)^{-1}}_{-(c+c_-)^{-1}} F(x) dx = \int\limits^\infty_{c+c_-} F \left(\frac{-1}{t} \right) \frac{dt}{t^2} + \int\limits^\infty_{c+c_+} F \left(\frac{1}{t} \right) \frac{dt}{t^2}\\
= \int\limits^\infty_C \left[X_-(t) F \left(\frac{-1}{t} \right) + X_+ (t) F \left(\frac{1}{t} \right) \right] \frac{dt}{t^2},
\end{gather*}
where 
$$
X_\mp (t) = 
\begin{aligned}
& 1 \text{ if } t \geqslant c + c_{\mp}\\
& 0 \text{ if } C \leqslant t < c + c_{\mp} .
\end{aligned}
$$
We\pageoriginale find that
$$
X_{\mp} (t) = \frac{t - C}{c} + \left(\left(\frac{C-c_{\mp}}{c} \right) \right) - \left(\left(\frac{t-c_{\mp}}{c} \right) \right)
$$
in $C\leqslant t < c+ C$ and clearly $X_{\mp}(t) =1$ if $t \geqslant c+ C$. Since $C < c+ c_{\mp} \leqslant c+ C$ and $cd_{\mp} - c_{\mp} d = \mp 1$ we have
$$
c_{\mp} = \left[\frac{C\mp d}{c} \right] c \pm \bar{d} \equiv \mp \bar{d} (\mod c).
$$
Hence we obtain
\begin{gather*}
\int\limits^{(c+c_+)^{-1}}_{-(c+c_-)^{-1}} F (x) dx = \int\limits^\infty_C \min \left\{1, \frac{t-C}{c} \right\} \left[F\left(\frac{-1}{t}\right)  + F \left(\frac{1}{t}\right) \right] \frac{dt}{t^2}\\
+ \int\limits^{c+C}_C \left\{\left(\left(\frac{C-d}{c} \right) \right)  - \left(\left(\frac{t-d}{c} \right) \right)\right\} F \left(-\frac{1}{t} \right) \frac{dt}{t^2}\\
+ \int\limits^{c+C}_C \left\{\left(\left(\frac{C+\bar{d}}{c} \right) \right) - \left(\left(\frac{t+\bar{d}}{c} \right) \right) \right\} F \left(\frac{1}{t} \right) \frac{dt}{t^2}.
\end{gather*}
Setting
$$
G_{tv} (f;c) = \sum\limits^\ast_{d(\mod c)} f\left(\frac{\bar{d} +t^{-1}}{c} \right)
$$
and 
$$
G_{tv} (f;c) =\sum\limits^\ast_{d(\mod c)} \left(\left(\frac{\bar{d} + v}{c} \right) \right) f \left(\frac{\bar{d} + t^{-1}}{c} \right)
$$
we conclude

\medskip
\noindent
{\bfseries Theorem \thnum{1}.\label{art6-thm1}}
\textit{We have }
\begin{gather*}
\mu(f) =\sum\limits^C_1 c^{-1} \int\limits^\infty_C \min \left\{1,\frac{t-C}{c} \right\} (G_t+ G_{-t}) (f;c) \frac{dt}{t^2}\\
+ \sum\limits^C_1 c^{-1} \int\limits^{c+C}_C (G_{tC} - G_{-t-C} + G_{-t-t} - G_{tt}) (f;c) \frac{dt}{t^2}
\end{gather*}

Now\pageoriginale suppose $f(x)$ is the additive character,
$$
f(x) = e(nx).
$$
We then have 
\begin{gather*}
\mu(f) = \delta (n),
G_t (f;c) = e \left(\frac{n}{ct} \right) S (n; c),
\end{gather*}
and 
$$
G_{tv} (f;c) = e \left(\frac{n}{ct} \right) S_v (n;c),
$$
so Theorem \ref{art6-thm1} turns into 

\medskip
\noindent
{\bfseries Theorem \thnum{2}.\label{art6-thm2}}
\textit{Let $C$ be a positive integer. We have }
$$
\delta (n) = D (n) + \overline{D} (n) + E (n) +\overline{E} (n)
$$
\textit{with }
$$
D(n) = \sum\limits^C_1 c^{-1} S (n;c) \int\limits^\infty_C e \left(\frac{n}{ct} \right) \min \left\{1, \frac{t-C}{c} \right\} \frac{dt}{t^2}. 
$$
\textit{and }
$$
E(n) = \sum\limits^C_1 c^{-1} \int\limits^{c+C}_C  e \left(\frac{n}{ct} \right) \left\{ S_C (n;c) - S_t (n;c)\right\} \frac{dt}{t^2}.
$$

\section{A formula for the Fourier coefficients of a cusp form.}\label{art6-sec3}
Now let $f$ be given by 
$$
f(x) =e(-nx) u (x+ iy),
$$
where $u(z)$ is an automorphic function with respect to the modular group $\Gamma=SL_2 (\bbZ)$. Thus we have 
$$
u \left(\frac{d+t^{-1}}{c} + iy \right) = u \left(\gamma \left(\frac{d+t^{-1}}{c} + iy \right)  \right) = u \left(\frac{-\bar{d}}{c} - \frac{c^{-1}t}{1+ icty} \right)
$$
for some $\gamma = \begin{pmatrix}
\ast & \ast \\
c & -d
\end{pmatrix} \in \Gamma$. Hence
$$
G_t (f;c) = e \left( \frac{-n}{ct}\right) \sum\limits^\ast_{d (\mod c)} e \left(-n \frac{\bar{d}}{c} \right) u \left(\frac{-d}{c} - \frac{c^{-1}t}{1+ icty} \right)
$$
and 
$$
G_{tv} (f;c) = e \left(\frac{-n}{ct} \right) \sum\limits^\ast_{d(\mod c)} \left(\left( \frac{d+v}{c}\right) \right) e \left(-n\frac{\bar{d}}{c} \right) u \left(\frac{-d}{c} - \frac{c^{-1}t}{1+icty} \right).
$$\pageoriginale 
Suppose $u(z)$ is a Maass cusp form, so it has the Fourier expansion
$$
u(z) = \sum\limits_{m\neq 0} \sigma_m W (mz),
$$ 
where $W(z)$ is the Whittaker function defined on $\bbC \ \bbR$ that satisfies the rules 
$$
W \left(\left(\begin{matrix}
1 & x\\
& 1
\end{matrix} 
 \right) z\right) = e(x) W (z)
$$
and 
$$
\overline{W} (z) = W (-\bar{z}), \; W (z) = W (\bar{z}).
$$
Hence it follows that 
\begin{gather*}
\mu (f) = \sigma_n W (iny),\\
G_t(f;c ) =e \left(\frac{-n}{ct} \right) \sum\limits^\ast_{m\neq 0} \sigma_m S (m,n;c) W \left(\frac{-mc^{-1}t}{1+icty} \right)
\end{gather*}
and 
$$
G_{tv} (f;c) = e \left( -\frac{n}{ct}\right) \sum\limits^\ast_{m \neq 0} \sigma_m S_v (-m , -n ; c) W \left( \frac{-mc^{-1} t}{1+ icty}\right)
$$
Combining the above evaluations with Theorem \ref{art6-thm1} and using the properties $S_v (-m, -n;c) = \overline{S}_v (m,n;c)$ and $S_{-v} (m, n;c) = - S_v (-m, -n; c)$ we conclude 

\medskip
\noindent
{\bfseries Theorem \thnum{3}.\label{art6-thm3}}
\textit{Let $u(z)$ be a Maass cusp form on the modular group whose Fourier coefficients $\sigma_m$ are real. Let $C$ be a positive integer. Then, for any $n\neq 0$, and $y>0$, we have}
$$
\sigma_n W (iny) = U (n,u) + \overline{U} (n,y) + V (n,y) + \overline{V} (n,y),
$$
\textit{where}
$$
U(n,y) = \sum\limits_{m\neq 0} \sigma_m \sum\limits^C_1 c^{-1} S (m, n;c) \int\limits^\infty_c e \left(\frac{n}{ct} \right) W \left(\frac{mc^{-1}t}{1-icty} \right) \min
\left\{1, \frac{t-C}{c} \right\} \frac{dt}{t^2}
$$
\textit{and}
\begin{multline*}
V (n,y) = \sum\limits_{m \neq 0} \sigma_m  \sum\limits^C_1 c^{-1} \times \\
\times \int\limits^{c+ C}_C e \left(\frac{n}{ct} \right) W \left(\frac{mc^{-1}t}{1-icty} \right) \{S_C (m,n;c) - S_t (m,n;c)\} \frac{dt}{t^2}.
\end{multline*}

%%%%% 54 page







%\begin{thebibliography}{99}
%\bibitem{art5-key1} 
%\end{thebibliography}

%\noindent
%{\bfseries Theorem \thnum{3(A)}.\label{art2-thm3A}}
