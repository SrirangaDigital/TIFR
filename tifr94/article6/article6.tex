
\title{ON MODULAR CURVES OVER FINITE FIELDS}
\markright{ON MODULAR CURVES OVER FINITE FIELDS}

\author{By~ YASUTAKA IHARA}
\markboth{YASUTAKA IHARA}{ON MODULAR CURVES OVER FINITE FIELDS}

\date{}
\maketitle


%\setcounter{page}{21}
\setcounter{pageoriginal}{160}

\noindent
\textsc{Introduction.}\pageoriginale We shall prove a certain basic theorem on modular curves over finite fields. This gives a solution of a conjecture raised at the Boulder summer school in 1965 \cite{art6-key7}. The congruence subgroup property of the modular group of degree two over $\bZ(1/p)$ is faithfully reflected in this theorem.

Let $p$ be a fixed prime number, $F$ be the algebraic closure of the prime field of characteristic $p$, and $F_{p^m} (m \geqslant 1)$ be the finite subfield of $F$ with $p^m$ elements. Let $j$ be a variable over $F$. For each positive integer $n$ with $p\nmid n$, let $L_n$ be the field of modular functions of level $n$ over $F(j)$ (with respect to $j$) in the sense of Igusa \cite{art6-key5}. Then $L_n / F (j)$ is a Galois extension with Galois group isomorphic to $SL_2 (\bL/ n) / \pm I$. We know that there is a \textit{canonical} choice of a Galois extension $K_n / F_{p^2} (j)$ with the same Galois group as $L_n / F(j)$, satisfying $K_n \cdot F= L_n$ and $K_n \cap F = F_{p^2}$ (\cite{art6-key7}, \cite{art6-key8}; see \S 1). The field $K_n$ is obtained as the fixed field of the action of $p^{\bZ} on L_n$. Call a prime divisor $P$ of $K_n$ \textit{supersingular} if the residue class of $j$ at $P$ is a supersingular ``$j$-invariant''. An important fact, which becomes apparent by lowering the field of modular functions from $L_n$ to $K_n$, is that \textit{all supersingular prime divisors of $K_n$ are of degree one over $F_{p^2}$}. This proof is in \cite{art6-key8}. For $n > 1$, the number of supersingular prime divisors of $K_n$ is equal to (1/12) $(p-1) [K_n: K_1]$. We shall prove that following 

\begin{theorem*}
There is no non-trivial unramified extension of $K_n$ in which all supersingular prime divisors are decomposed completely.
\end{theorem*}

This, combined with Igusa's result \cite{art6-key5} on the ramifications of $L_n/L_1$ (which says that the ramifications of $L_n/L_1$ are almost analogous to those of the corresponding situation in characteristic 0), gives the following complete characterization of the Galois extension $K_\infty/ K_r$, where $r >1$ and $K_\infty$ is the composite of $K_n$ for all $n$:

\begin{coro*}
$K_\infty/ K_r$ is the maximum Galois extension of $K_r$ satisfying the following two properties; (i) it is tamely ramified, and unramified outside\pageoriginale the cusps of $K_r$; (ii) the supersingular prime divisors $af$ $K_r$ are decomposed completely.
\end{coro*}     

If one wants to emphasize the arithmetic nature of the theorem, one may restate the theorem in the following way: \textit{``the Galois group of the maximum unramified Galois extension of $K_n$ is topologically generated by the $p^2$-th power Frobenius automorphisms of (all extensions of) the supersingular prime divisors of $K_n$.''} Some direct applications of this to the distribution of supersingular prime divisors are given in \S 2. If one wants to look at the theorem as a theorem on the fundamental group, one may formulate it as follows. let $\Gamma_1 = PSL_2 (Z^{(z)})$ be the modular group over $\bZ^{(p)} = \bZ[1/p]$ and $\Gamma_n$ the principle congruence subgroup of $\Gamma_1$ with level $n (p\nmid n)$. Let $X_n$ be a complete non-singular model of $K_n$. Then, for $r > 1$, \textit{``there is a categorical equivalence between subgroups of $\Gamma_r$ with finite indices and those finite separable irreducible coverings of $X_r$ defined over $F_{p^2}$ and satisfying the above two conditions} (i), (ii).'' (The second condition (ii) is geometrically stated as ``all points lying on the supersingular points of $X_r$ are $F_{p^2}$-rational''.) In this sense, the modular group of degree two over $\bZ^{(p)}$ is \textit{the fundamental group} defined by (i), (ii).

We shall mention here that it is essential to consider the groups over $\bZ^{(p)}$ and the curves over $F_{p^2}$. It cannot be replaced by the groups over $\bZ$ and the curves $F$. Roughly speaking, considering the group over $\bZ$ corresponds to considering the condition (i) alone. The condition (i) alone cannot characterize the system of coverings defined by the modular curves $X_n$, as each $X_n$ for $n \geqslant 6$ has so many non-trivial unramified coverings and they are all from \textit{outside} the system (see \S 1. 2, \S 2). Such unramified coverings of $X_n$ correspond to \textit{non-congruence subgroups} of $PSL_2 (\bZ)$. The passage from $PSL_2 (\bZ)$ to $PSL_2 (\bZ^{(p)})$ kills all non-congruence subgroups. Our theorem says, as a corresponding geometric fact, that all non-trivial unramified coverings of $X_n$ are killed by the condition (ii), \ie, by \textit{the super-singular Frobeniuses}. The connection between the function field $K_n$ (or the curve $X_n$) and $\Gamma_n$ is essential, as our previous studies \cite{art6-key7}, \cite{art6-key8}, and also the proof of the present theorem show.

In \S\ref{art6-sec1}, we\pageoriginale shall give some preliminaries, and in \S \ref{art6-sec2}, we shall state our theorem in several different forms, with some corollaries. The proof will be given in he rest of the paper, in \S\S \ref{art6-sec3}-\ref{art6-sec6}.

\textsc{Method for proof.} The modular group over $\bZ^{(p)}$ has the congruence subgroup property (Mennicke, Serre), and our theorem is a faithful reflection of this property. The proof goes through directly by chasing away the obstacles (clouds!). It consists of the following steps (a)-(d).
\begin{itemize}
\item[(a)] A geometric interpretation of the congruence subgroup property as the ``simply-connectedness'' of the system $\{R_n \xleftarrow{\varphi} R^0_n \xrightarrow{\varphi'} R'_n\}$ of three compact Riemann surfaces. The Riemann surfaces $R_n$, $R'_n$ and $R^0_n$ are defined by the fuchsian groups $\Delta_n, \Delta'_n$ and $\Delta^0_n$, where $\Delta_n$ is the principal congruence subgroup of $PSL_2 (\bZ)$ of level $n$,
$$
\Delta'_n = 
\begin{pmatrix}
p & 0 \\
0 & 1
\end{pmatrix}^{-1}
\Delta_n 
\begin{pmatrix}
p & 0 \\
0 & 1
\end{pmatrix}, \text{ and }
\Delta^0_n = \Delta_n \cap \Delta'_n.
$$
The system is essentially the graph of the modular correspondence ``$T(p)$ for level $n$''. (However, $R^0_n$ is not immersed in the product $R_n \times R'_n$.) The interpretation is made possible due to the fact that $\Gamma_n$ is the \textit{free} product of $\Delta_n$ and $\Delta'_n$ with amalgamated subgroup $\Delta^0_n$. And the congruence subgroup property is used in the following form that $\Gamma_n$ is generated only by the parabolic elements (\S 3).


\item[(b)] A geometric interpretation of the theorem to be proved as the ``simply-connectedness'' of the system $\{X_n \xleftarrow{\psi} X^0_n\xrightarrow{\psi'} X'_n\}$ of three $F_{p^2}$-curves. Here, $X_n$ is as above, $X'_n$ is its conjugate over $F_p$, and $X^0_n$ is the union of the graphs $\Pi$, $\Pi'$ of two $p$-th power morphisms $X_n \to X'_n$, $X'_n \to X_n$ (both graphs being taken on $X_n \times X'_n$. Actually, $X^0_n$ is partially normalized so that $\Pi$ and $\Pi'$ are \textit{crossing only at the supersingular points} (\S 4).

\item[(c)] The bridge connecting these two systems, \ie, the congruence relation ``$R^0_n \equiv \Pi + \Pi' (\mod p)$''. This is presented in \S 5.1. Due to our canonical choice of the curves over $F_{p^2}$ and their $p$-adic lifting, where the action of $p^\bZ$ is trivialized, the congruence relation is in its \textit{symmetric} form. Also, we use the non-singular curve $R^0_n$ instead of its image in $R_n \times R'_n$, and this corresponds to that $\Pi, \Pi'$ are crossing\pageoriginale only at the supersingular points.\footnote{We learnt this from Igusa \cite{art6-key5}, p. 472 (footnote); cf. also Deligne [i], No. 4} Besider the general formulations of congruence relations by Shimura \cite{art6-key18}, it is also meaningful to draw attention to this canonical and natural form of the congruence relation.

\item[(d)] Passing the bridge, using a celebrated theorem of Grothen-dieck on the unique $p$-adic liftability of \'etale coverings (\S 6).

I am very grateful to Professor P. Deligne who read my first version of the proof and kindly pointed out to me a simplification by an extended use of a theorem of Grothendieck (see \S 6.2).
\end{itemize}

\section{Preliminaries.}\label{art6-sec1}
 We shall review the definitions and some basic facts related to the fields of modular functions over finite fields.

\subsection{}\label{art6-subsec1.1}
Let $p$ be the fixed prime number, and $n$ be a positive integer not divisible by $p$. In \S \ref{art6-subsec1.1}, $F_p$ will denote any field of characteristic either 0 or $p$, satisfying the following condition. Let $W_n$ be the group of $n$-th roots of unity in the fixed separable closure of $F_p$, let $W_\infty$ be the inductive union of $W_n$ for all $n$ (with $p \nmid n$), and consider the cyclotomic extension $F = F_p (W_\infty)$. Then our condition on $F_p$ is that the Galois group $G(F/ F_p)$ contains, and is topologically generated by, a special element $\sigma$ that acts on $W_\infty$ as $\zeta \to \zeta^p$. This being assumed, put $F_{p^m} = F_p (W_{p^m -1})$, for each positive integer $m$. Then $F_{p^m}$ is a cyclic extension of $F_p$ with degree $m$, and it is the fixed field of $\sigma^m$ in $F$. The Krull topology of $G(F/F_p)$ induces, \textit{via} $\sigma^\bZ$, the product of $l$-adic topologies of $\bZ$ over all prime numbers $l$ (including p), and $G(F/F_p)$ is canonically isomorphic to the completion $\hat{\bZ}$ of $\bZ$ by this topology. For each $a \in \hat{\bZ}$, the corresponding element of $G (F/ F_p)$ will be denoted by $\sigma^a$, and the automorphism of $W_\infty$ induced by $\sigma^a$ will be denoted simply as ``$p^a$''. Examples of $F_p$ are the prime field of characteristic $p$, the $p$-adic field $\bQ_p$, the decomposition field of $p$ in the cyclotomic field $\bQ(W_\infty)$ over the rational number field $\bQ$, etc.

Now let $j$ be a variable over $F_p$, and $E$ be any elliptic curve over the rational function field $F_p(j)$, having $j$ as its absolute invariant. The equation of Tate,
\begin{equation} 
Y^2 + XY = X^3 - \frac{36}{j - 1728} X - \frac{1}{j - 1728},
\tag{$(T)_j$}
\end{equation}\pageoriginale 
gives an example of $E$. For each $n$, let $E_n$ be the group of $n$-th division points of $E$, and put $E_\infty = \bigcup\limits_{p\nmid n} E_n$. Then, since $E_n \simeq (\bZ/ n)^2$  the determinant give a homomorphism $\Aut E_n \to (\bZ / n)^\times$. Identifying the two groups $(\bZ/ n)^\times$ and $\Aut W_n$ in the canonical way, we shall consider the determinant as giving a homomorphism $\Aut E_n \to \Aut W_n$, which will be filtrated to the homomorphism at infinity,
\begin{equation}
\det: \Aut E_\infty \to \Aut W_\infty. \label{art6-eq1.1.1}
\end{equation}
Let $\fg$ be the Galois group over $F_p(j)$ of its separable closure. Then $\fg$ acts on $E_\infty$ and $W_\infty$, and the two actions are compatible with the homomorphism \eqref{art6-eq1.1.1}. In particular, by our assumption on $F_p$, the determinant of the action of each element of $\fg$ on $E_\infty$ must belong to $p^{\hat{\bZ}}$.

\setcounter{subprop}{1}
\begin{subprop}[Igusa]\label{art6-subprop1.1.2}
The subgroup of $\Aut E_\infty$ generated by the change of sign $-1_\infty$ ($1_\infty$: the identify map of $E_\infty$) and the actions of all elements of $\fg$ on $E_\infty$ consists of all those elements of $\Aut E_\infty$ whose determinants belong to $p^{\hat{\bZ}}$.
\end{subprop}

\begin{proof}
By Igusa \cite{art6-key5}, this subgroup contains all elements with determinant unity, as $j$ is a variable over $F$. The Proposition follows immediately from this and our assumption on $F_p$. (For characteristic 0, see also Shimura \cite{art6-17}, \cite{art6-18}.)
\end{proof}

\begin{coro*}
For at least one choice of the sign $\pm$, there exists an element of $\fg$ acting on $E_\infty$ as $\pm p \cdot 1_\infty$.
\end{coro*}

\begin{definitions*}
The fields on the left are by definition the fixed fields of the groups on the right. The groups are closed subgroups of $\fg$ defined by their actions on $E_\infty$ and $W_\infty$ (the two actions being connected by the determinant). The symbol ``1'' denotes the identity map of the indicated group.
$$
\xymatrix@R=0.1cm@C=0.5cm{
& L_\infty \ar@{-}[dd]\\
K_\infty \ar@{-}[ur] \ar@{-}[dd]& \\
& L_n \ar@{-}[dd] \\
K_n \ar@{-}[ur] \ar@{-}[dd]&\\
& L_1 = F(j)\\
K_1 - F_{p^2} (j) \ar@{-}[ur]& 
}
\quad
\xymatrix@R=0.1cm@C=0.5cm{
& \{ \pm 1 \; on\; E_\infty \} \ar@{-}[dd]\\
\{\pm p^{\hat{\bZ}} \;on\; E_\infty\}\ar@{-}[ur] \ar@{-}[dd]& \\
& \{\pm 1 \;on\; E_n \cdot 1 \; on \; W_\infty\} \ar@{-}[dd] \\
\{(1.1.3)\}  \ar@{-}[ur] \ar@{-}[dd]&\\
& \{1 \; on \; W_\infty \}\\
\{p^{2 \hat{\bZ}} \; on \; W_\infty\}  \ar@{-}[ur]& 
}
$$
The group\pageoriginale corresponding to $K_n$ is defined by 
\setcounter{equation}{2} 
\begin{equation}
\{\pm p^a \; on \; E_n \; and \; p^{2a} \;on\; W_\infty \textit{\; for some common } a \in \hat{\bZ}\}. \label{art6-eq1.1.3}
\end{equation}
It is the composite of the groups corresponding to $K_\infty$ and $L_n$. 

Thus, $K_n$ is a finite Galois extension of $F_p(j)$, and it is an algebraic function field of one variable with exact constant field $F_{p^2}$. The field $L_n$ is the field of modular functions of level $n$ over $F(j)$ in the sense of \cite{art6-key5}, and the relations between $L_n$ and $K_n$ are $L_n = K_n \cdot F$, $K_n = L_n \cap K_\infty$. The fields $L_\infty$, $K_\infty$ are the composites of $L_n $, $K_n$ for all $n$, and $L_\infty = K_\infty \cdot F$.

The Galois group $G(K_n/ K_1)$ is canonically isomorphic to $G(L_n / L_1)$, and hence by Prop. \ref{art6-subprop1.1.2}., canonically isomorphic to $\Aut^1 E_n/\pm I$, where $\Aut^1 E_n$ is the group of all automorphisms of $E_n$ with determinant unity. So, each choice of an isomorphism $\epsilon_n : E_n \tilde{\to} (\bZ/n)^2$  defines an isomorphism $\alpha_n : G (K_n / K_1) \tilde{\to} S L_2 (\bZ/n) / \pm I$. If we fix an isomorphism $\omega_n : W_n \tilde{\to} \bZ/n$, we can impose on $\epsilon_n$ the following condition that 
\begin{equation}
\omega_n (e(u,v)) = |\epsilon_n u, \epsilon_n v|, \; (u, v \in E_n),
\label{art6-eq1.1.4}
\end{equation}
where $e : E_n \times E_n \to W_n$ is the Weil's Riemannian form with respect to the divisor ($\equiv -$) class of \textit{degree one} (Weil \cite{art6-key19} Ch. IX), and is the matricial  determinant. This condition \eqref{art6-eq1.1.4} defines a unique $SL_2 (\bZ/n)$-class of $\epsilon_n$, and hence a unique class of $\alpha_n$ modulo inner automorphisms. We shall fix an isomorphism
\begin{equation}
\omega : W_\infty\tilde{\to} \underrightarrow{\lim} \bZ / n, \label{art6-eq1.1.5}
\end{equation}
which defines a unique class of isomorphisms
\begin{equation}
\alpha : G (K_\infty / K_1) \tilde{\longrightarrow} \underleftarrow{\lim} (SL_2 (\bZ/ n) / \pm I)
\label{art6-eq1.1.6}
\end{equation}
modulo inner automorphisms.

Let $\Gamma_1 = PSL_2 (\bZ^{(p)})$ be the modular group over $\bZ^{(p)} = \bZ[1/p]$ and $\Gamma_n$ be the principal congruence subgroup of level $n$. Then $\Gamma_1/ \Gamma_n$ is canonically isomorphic to $SL_2 (\bZ/n) \pm I$; hence the right side of \eqref{art6-eq1.1.6} is canonically isomorphic to $\underleftarrow{\lim} (\Gamma_1/\Gamma_n)$. Therefore, \eqref{art6-eq1.1.6} induces an injection
\begin{equation}
\iota : \Gamma_1 \hookrightarrow G (K_\infty / K_1).  \label{art6-eq1.1.7}
\end{equation}
which\pageoriginale is intrinsic up to inner automorphisms of $G(K_\infty/ K_1)$, once $\omega$ is fixed. The congruence subgroups of $\Gamma_1$ are in one-to-one correspondence with finite extensions of $K_1$ in $K_\infty$. In particular, $\Gamma_n$ corresponds to $K_n$ (for any choice of $\omega$).

It is easy to check that the fields $K_n$, $L_n$ are independent of the special choice of $E$. Also, the classes of $\alpha$ and $\iota$, considered up to inner automorphisms of $G(K_\infty/ K_1)$, depend only on $\omega$ and not on the special choice of $E$.

We shall call $K_n$ the field of modular functions of level $n$ over $F_{p^2}$.
\end{definitions*}

\subsection{}\label{art6-sbusec1.2}
Now we shall specify $F_p$ as the prime field of characteristic $p$, so that $F$ is the algebraic closure of $F_p$ and $W_\infty = F^\times$. For each $a \in F \cup (\infty)$, $P_a$ will denote the prime divisor of the function field $K_1 = F_{p^2} (j)$ defined by $j \equiv a (\mod P_a)$. So, for $a, b \in F$, $P_a = P_b$ holds if and only if $a$, $b$ are conjugate over $F_{p^2}$. The prime divisor $P_\infty$ is called cuspidal, and $P_a$ is called supersingular if $a$ is a super-singular ``$j$-invariant'' In the latter case, we have $a \in F_{p^2}$, so that all supersingular prime divisors of $K_1$ are of degree one over $F_{p^2}$. Other special prime divisors of $K_1$ are $P_{1728}$ and $P_0$. When $p=2$ or 3, $P_{1728} = P_0$ is the unique supersingular prime divisor of $K_1$. In all other cases, $P_{1728}(\resp. P_0)$  is supersingular if and only if $p \equiv -1 (\mod 4) (\resp. p \equiv -1 (\mod 3))$. For any intermediate field $K$ of $K_\infty/ K_1$ and a prime divisor $P$ of $K$, we call $P$ cuspidal (\resp. super-singular) when its restriction to $K_1$ is cuspidal (\resp. supersingular). We shall review some basic facts about the Galois extension $K_\infty/ L_1$.

\noindent
\textsc{The Ramification.} 
It is independent of the constant field. Hence the ramification of $K_\infty/ K_1$ is described by that of $L_\infty/ L_1$, which was determined by Igusa \cite{art6-key5} as follows.

\noindent
{\bf (IG. 1)} $P= P_\infty$. It is tamely ramified in $K_\infty / K_1$, and has an extension to $K_\infty$ whose inertia group is topologically generated by $\iota \left(\begin{pmatrix}
1&1\\
0&1
\end{pmatrix} \right)\footnote{This last point is not explicitly stated in \cite{art6-key5}, but follows easily from the arguments used there. See also \cite{art6-key8}, II, Ch. 5, \S 28 for an alternative proof.}$.

In particular,\pageoriginale the ramification index of $P_\infty$ in $K_n / K_1$ is equal to $n$, and moreover, $K_n$ is the maximum extension of $K_1$ in $K_\infty$ with this property. The second point follows immediately from the \textit{local} congruence subgroup property of $PSL_2$, that the principal congruence subgroup of level $n$ of the group $\underleftarrow{\lim} (SL_2 (\bZ/n'))$ is normally generated by $\begin{pmatrix}
1 & n \\ 0 & 1\end{pmatrix}$ in the topological sense. Thus:

\begin{subprop}
There is no non-trivial unramified extension of $K_n$ contained in $K_\infty$.
\end{subprop}

This implies that all non-trivial unramified extensions of $K_n$, for each $n$, are \textit{outside} $K_\infty$.

\noindent
\textbf{(IG. 2)} $P=P_{1728}$, $P_0$. If $p \neq 2, 3$, these prime divisors are tamely ramified in $K_\infty$ with indices 2, 3, respectively. If $p=2$ or $p=3$, $P_{1728} = P_0$ is wildly ramified with indices $12(p=2)$ or $6(p=3)$. In all cases, the ramifications of $P_{1728}$, $P_0$ in $K_\infty/ K_1$ are accomplished in $K_n/K_1$ for any $n > 1$, so that each extension of $P_{1728}$ or $P_0$ is unramified in $K_\infty/ K_n$ for $n>1$.

\noindent
\textbf{(IG. 3)} $P \neq P_\infty$, $P_{1728}$, $P_0$. These prime divisors $P$ are unramified in $K_\infty / K_1$. 

\subsection{}\label{art6-subsec1.3}
\textit{The decomposition.} The following assertion is an immediate consequence of Theorem 3, 4, 5 of our previous note \cite{art6-key8}, II, Ch. 5 (\S\S 24, 26, 28). It can also be proved directly without any essential difficulty.

\begin{subprop}\label{art6-subprop1.3.1}
A prime divisor of $K_\infty$ is of degree one over $F_{p^2}$ if and only if it is supersingular.
\end{subprop}

(This includes in particular that the cuspidal prime divisors of $K_\infty$ are \textit{not} of degree one over $F_{p^2}$.)

As a direct formal consequence of Prop. \ref{art6-subprop1.3.1}., we have:

\medskip
\noindent
\textbf{Proposition 1.3.1$'$.} 
\textit{There exists a non-zero ideal $n_0\bZ$ of $\bZ$ such that for each $b \in n_0 \bZ$, the prime divisors of $K_n$ of degree one over $F_{p^2}$ are precisely the supersingular prine divisors of $K_n$.}

Let\pageoriginale $h_n$ denote the number of supersingular prime divisors of $K_n$. It is well known that
\begin{align*}
h_1 & = \frac{1}{12} (p+13) - \frac{1}{4} \left(1 + \left(\frac{-1}{p} \right)\right) - \frac{1}{3} \left(1+ \left(\frac{-3}{p} \right) \right), \tag*{$(1.3.2)_1$}\\
h_n & = \frac{1}{12} (p-1) [K_n : K_1], \quad (n > 1). \tag*{$(1.3.2)_n$}
\end{align*}
The second formula follows from the first by using (IG2), (IG3).

In \cite{art6-key8}, Ch. 5, more intimate arithmetic relations between the group $\Gamma_n$ and the field $K_n$ are presented, but they will not be directly used here.


\section{The main theorem.}\label{art6-sec2}

\subsection{}\label{art6-subsec2.1}
For each positive integer $n$ with $p \nmid n$, let $K_n$ be the modular function field of level $n$ over the finite field $F_{p^2}$ defined in $\S 1$. Then, $K_n$ has a special finite set of prime divisors $s_1, \ldots, s_{h_n}$ of degree one, the supersingular prime divisors, where $h_n = \dfrac{1}{12} (p-1) [K_n : K_1]$ for $n >1$ (see \S \ref{art6-subsec1.3}).


\noindent
\textsc{Main Theorem (First formulation).} 
\textit{Let $M_n$ be the maximum unramified Galois extension of $K_n$, and $s_1, \ldots, s_{h_n}$ be the set of all supersingular prime divisors of $K_n$. Then the Frobenius conjugacy classes $\left\{\dfrac{M_n/K_n}{S_i} \right\}$ of $s_i (i=1, \ldots, h_n)$ generated, in the topological sense, the Galois group of $M_n / K_n$.}

(Since $M_n/K_n$ is generally non-abelian, the Frobenius automorphism associates to each prime divisor of $K_n$ a conjugacy class of the Galois group, which is called the Frobenius conjugacy class.)

In a more suggestive way, one may state it as ``\textit{the non-abelian divisor class group of $K_n$ is generated by the supersingular prime divisors $s_1,\ldots, s_{h_n}$.''}

The restriction of the theorem to abelian extensions gives:

\begin{corollary}\label{art6-coro1}
The divisor class group of $K_n$ is generated by the classes of supersingular prime divisors $s_1, \ldots, s_{h_n}$.
\end{corollary}

\begin{remark}\label{art6-rem1}
According\pageoriginale to the Grothendieck theory of fundamental groups, the Galois group of the maximum unramified Galois extension of an algebraic function field of genus $g > 0$ (over any algebraically closed constant field) is isomorphic to the projective limit of \textit{some subsystem} of the system of all finite factor groups of the abstract group defined by $2g$ generators $\alpha_1, \ldots, \alpha_g$, $\beta_1, \ldots, \beta_g$ with a single relation
$$
\alpha_1 \beta_1 \alpha^{-1}_1 \beta^{-1}_1 \ldots \alpha_g \beta_g \alpha_g^{-1} \beta^{-1}_g = 1.
$$
For characteristic 0, it is the projective limit of \textit{all} finite factor groups (as is classically well known), and for characteristic $p>0$, the best (general type) information on this subsystem is that it contains all those finite factor groups whose orders are not divisible by $p$. This gives a general idea on the structure of the Galois group. Note that \textit{our result is of a completely different type}. It also gives some topological generators of the Galois group, but its aim is not to describe the structure of the Galois group, but \textit{to describe the arithmetic distriction of supersingular prime divisors and to characterize the field $K_n$ by ramifications and supersingular complete decompositions} (see [MT 3] below). While the structure of the Galois group of $M_n/K_n$  itself is similar to the case of characteristic 0, our assertion is what properly belongs to characteristic $p>0$.

It is necessary to look at our theorem from several different angles, and so we shall present various different (but equivalent) versions of the theorem under the names [MT i]. The first formulation will hereafter be cited as [MT 1]$_n$. For example, and immediate variation is the following:

[MT 2]$_n$. \textit{There is no non-trivial unramified extension of $K_n$ in which all supersingular prime divisors $s_1, \ldots, s_{j_n}$ of $K_n$ are decomposed completely.}
\end{remark}

\begin{remark}\label{art6-rem2}
If $K'$ is a finite unramified extension of $K_n$ in which $s_1, \ldots, s_{h_n}$ are decomposed completely, the curve for $K'$ has at least $[K': K_n]. h_n$ number of $F_{p^2}$-rational points. It should be mentioned here that [MT 2]$_n$ \textit{cannot} be proved only by the estimation of the number of rational points.

The above\pageoriginale two formulations of the theorem are convenient for the presentations of the \textit{new} part of its content. But to exhibit its natural form, we must let $n \to \infty$. As noted in \S \ref{art6-sec1}, the constant field extension $L_n = K_n \cdot F$ is nothing but the modular function field of level $n$ over $F(j)$ in the sense of \cite{art6-key5}. Let $M_n$ be, as in [MT 1]$_n$, the maximum unramified Galois extension of $K_n$ (or equivalently, of $L_n$), and take the composites $M_\infty$, $L_\infty$, $K_\infty$ of $M_n$, $L_n$, $K_n$ for all $n$ (with $p\nmid n$):
$$
\xymatrix@R=-0.15cm@C=0.5cm{
& & & M_\infty \ar@{-}[ddll]\\
& & \ar@{-}[ddd] &\\
& L_\infty \ar@{-}[ddd]& &\\
K_\infty\ar@{-}[ddd]\ar@{-}[ur] & & &\\
& & M_n \ar@{-}[dl] &\\
& L_n \ar@{-}[ddd]& &\\
K_n \ar@{-}[ddd]\ar@{-}[ur] & & &\\
& & &&\\
& L_1 = F (j) & &\\
K_1 = F_{p^2} (j)\ar@{-}[ur] & & &
}
$$
By Prop. \ref{art6-subprop1.2.1}, we have $M_n \cap K_\infty = K_n$ and (equivalently) $M_n \cap L_\infty =L_n$. No, [MT 1]$_n$ gives immediately:

[MT 1]$_\infty$ (\resp. [MT 2]$_\infty$). \textit{One can replace $n$ by $\infty$ in} [MT 1]$_n$ (\resp. [MT 2]$_n$).

Here, by definition, the unramified extensions of $K_\infty$ are those extensions of $K_\infty$ contained in $M_\infty$.

Fix any positive integer $r$ with $r > 1$ and $p \nmid r$. Let $n$ be any positive integer with $p \nmid n$. Then, as reviewed in \S \ref{art6-subsec1.2}, $L_{nr}/ L_r$ is unramified outside the cusps, and the ramification index at each cusp is precisely $n$. In particular, the cusps are tamely ramified. Therefore, $M_{nr}$ (\resp. $M_\infty$) is the maximum Galois extension of $K_r$ satisfying the following condition (i 1)(i 2)$_n$ (\resp. (i 1) (i 2)$_\infty$);
\begin{itemize}
\item[(i 1)~] \textit{it is unramified outside the cusps of $K_r$,}

\item[(i 2)$_n$] \textit{the ramification index of each cusp is a factor of $n$, \resp.}

\item[(i 2)$_\infty$] \textit{each cusp is at most tamely ramified.}
\end{itemize}
Therefore, we obtain from [MT 2] the following simple characterization of $K_{nr}$ (\resp. $K_\infty$).
\end{remark}

\medskip
[MT 3] $K_nr$ (\resp $K_\infty$) \textit{is the maximum Galois extension of $K_r$ satisfying} (i 1)(i 2)$_n$ (\textit{\resp} (i 1)(i 2 )$_\infty$) \textit{and the following property} (ii):

\begin{itemize}
\item[(ii)] \textit{the supersingular prime divisors of $K_r$ are decomposed completely.}
\end{itemize}

Of course, to be able to say that ``[MT 3] characterizes $K_{nr}$ (or $K_\infty$)'', it is necessary that the base field $K_r$, its cusps, and its supersingular prime divisors are all explicitly presentable. A well-known case when they are explicitly presented is where $r = 2 (p \neq 2)$. Then $K_2 = F_{p^2} (\lambda)$, the rational function field, with cusps at $0, 1, \infty$, and supersingular prime divisors at the zeros of the polynomial
$$
P(\lambda) = \sum\limits^b_{i=0} \begin{pmatrix}
b \\
i
\end{pmatrix}^2  \lambda^i, \quad (b = \frac{1}{2} (p-1)),
$$
the prime divisors of $K_2$ being expressed by the residue classes of $\lambda$. Therefore, this special case gives the following.
 
\textit{Let $p$ be an odd prime and $n$ be a positive integer with $p \nmid n$. Then $K_\infty (\resp. K_{2n})$ is the maximum Galois extension of $F_{p^2}(\lambda)$ satisfying:}
\begin{itemize}
\item[(i 1)] \textit{it is unramified outside 0, 1, $\infty$:}

\item[(i 2)] (\resp (i 2)$_n$) 0, 1, $\infty$ \textit{are tamely ramified (\resp. 0, 1, $\infty$ are tamely ramified with ramification index dividing $n$);}

\item[(iii)] \textit{the zeros of $P(\lambda)$ are decomposed completely.}
\end{itemize}

One may restate [MT 3] in a more suggestive way as ``\textit{the subgroup of the non-abelian divisor class group of $K_r$ with conductor $\prod\limits^\nu_{i=1} c_i$, the product of all distinct cusps of $K_r$, and generated by the supersingular prime divisors $s_1, \ldots, s_{h_r}$ of $K_r$, is precisely that group corresponding to the Galois extension $K_\infty$ of $K_r$''.}

The restriction to abelian extensions gives:

\begin{corollary}\label{art6-coro2}
The subgroup of the divisor class group of $K_r$ with cuspidal conductor $\prod\limits^\nu_{i=1} c_i$ and generated by the supersingular prime divisors $s_1, \ldots, s_{h_r}$ is precisely that group corresponding to the maximum abelian extension of $K_r$ contained in $K_\infty$.
\end{corollary}

For example,\pageoriginale if $r = 2$, the maximum abelian extension of $K_2$ in $K_\infty$ is given by 
\begin{gather*}
F_{p^2 } (\lambda; (-\lambda)^{1/8}, (-\lambda')^{1/8}, (\frac{1}{2} \lambda \lambda')^{1/3}) \qquad (p \neq 2, 3), \\
F_{p^2 } (\lambda; (-\lambda)^{1/8} , (-\lambda')^{1/8}) \qquad (p = 3),
\end{gather*}
where $\lambda' = 1 -\lambda$. Therefore, we obtain easily from Corollary \ref{art6-coro2} the following multiplicative property of the set of supersingular ``$\lambda$-invariants''.

\begin{corollary}[$p \neq 2,3$]\label{art6-coro3}
Consider the group $\tilde{G} = (F^\times_{p^2})^8 \times (F^\times_{p^2})^8$ and the subgroup $H= \{(x,y) \in \tilde{G} | xy \in (F^\times_{p^2})^{24} \}$ of $\tilde{G}$ with index 3. Define an $H$-coset $H'$ by $H' = \{(x,y) \in \tilde{C} | \frac{1}{2} xy \in (F^\times_{p^2})^{24}\}$, and let $G$ be the subgroup of $\tilde{G}$ generated by $H'$. Let $S$ be the set of all zeros of $P(\lambda)$. For each $s \in S$ put $g_s = (-s, -s')$, where $s' = 1 -s$. Then 
\begin{description}
\item[\quad \qquad {\rm (a)}] $g_s \in H'$ for any $s \in S$,

\item[\quad \qquad {\rm (b)}] $g_s \cdot g^{-1}_t (s, t \in S)$  generate $H$;

\item[{\rm hence ~~(c)}]  $g_s (s \in S)$ generate $G$.
\end{description}
\end{corollary}

Finally, let $\Gamma_1 = PSL_2 (\bZ^{(p)})$ and $\Gamma_n$ be the principal congruence subgroup of level $n$. Then, in view of the isomorphism $G (K_\infty/ K_1) \tilde{\to} \underleftarrow{\lim} \Gamma_1 / \Gamma_n$ (\S \ref{art6-subsec1.1}) and the congruence subgroup property of $\Gamma_1$, [MT 3] can also be formulated as follows:

[MT 4]. \textit{There is a categorical equivalence between subgroups with finite indices of $\Gamma_r$ and finite extensions of $K_r$ satisfying (i 1), (i 2) and (ii).}

Or in short,  ``\textit{$\Gamma_r$ is the strict fundamental group of $K_r$ defined by} (i 1), (i 2) {\it and} (ii)''.

In \S \ref{art6-sec4}, a more geometric version of [MT]'s will be given. 


\begin{remark}\label{art6-rem3}
[MT 3] characterizes the extensions $K_{nr}/ K_r$, for $r > 1$. If one wants to take $K_1$ as the base field, one must first observe that not only the cusp $P_\infty$ but also $P_{1728}$ and $P_0$ are ramified in $K_\infty/ K_1$. If $p\neq 2$, 3 and $n >1$, the ramification indices of these three prime divisors of $K_1$ in $K_n/K_1$ are $n$, 2, 3, respectively (and all other prime divisors of $K_1$ are unramified). So, by [MT 2]$_n$, $K_n$ is a \textit{maximal} extension\pageoriginale of $K_1$ having (i) this ramification property, and (ii) the property that all prime divisors lying on the supersingular prime divisors of $K_1$ are of degree one over $F_{p^2}$. But here, we cannot replace ``\textit{maximal}'' by ``\textit{maximum}''. In fact, due to the situation that the ramifying prime divisors $P_{1728}$ or $P_0$ can be supersingular (for  $p\equiv -1 (\mod 4)$ or $-1 (\mod 3)$ respectively), the composite of two extensions of $K_1$ satisfying above two properties may \textit{not} satisfy them. This is why we did not formulate the characterization of the extension $K_{nr}/K_r$ for $r =1$. Our theorem was formulated as a conjecture in \cite{art6-key7}, \cite{art6-key8} and \cite{art6-key9}. Among them, the formulation in \cite{art6-key8}, II, Ch. 5, ``$\hat{\fK} = \fK$ ?'', contains an error in the definition of $\hat{\fK}$ arising from the misobservation of this subtle situation which, of course, can be easily corrected.\footnote{The second definition on p. 179 (\cite{art6-key8} II) is the correct one.}
\end{remark}

\section{The complex system $\{R_n {\displaystyle{\mathop{\longleftarrow}^\varphi}} R^0_n  {\displaystyle{\mathop{\longrightarrow}^{\varphi'}}} R'_n \}$.}\label{art6-sec3}
In this section, we shall prove a lemma in characteristic 0, which is \textit{the complex version} of the theorem to proved. It is a reflection of the congruence subgroup property of the modular group over $\bZ^{(p)}$. This property is in fact faithfully reflected due to the fact that the modular group over $\bZ^{(p)}$ is a free product of two modular groups over $\bZ$ with amalgamation. Our theorem will finally be reduced to this lemma.

\subsection{}\label{art6-subsec3.1}
Consider a system $\{R {\displaystyle{\mathop{\longleftarrow}^\varphi}} R^0  {\displaystyle{\mathop{\longrightarrow}^{\varphi'}}} R' \}$ of compact Riemann surfaces $R$, $R'$, $R^0$ and surjective morphisms $\varphi$, $\varphi'$. \textit{unramified covering} of such a system $\{R {\displaystyle{\mathop{\longleftarrow}^\varphi}} R^0  {\displaystyle{\mathop{\longrightarrow}^{\varphi'}}} R' \}$ is defined by a commutative diagram
\setcounter{equation}{0}
\begin{equation}
\vcenter{
\xymatrix@R=-0.05cm@C=1cm{
& R^{\ast^0} \ar[dr]^{\varphi^{\ast'}} \ar[dl]_{\varphi^\ast} \ar[ddd]_{f^0} & \\
R^\ast \ar[ddd]_{f} &&  R^{\ast'} \ar[ddd]_{f'}\\
& & &\\
& R^0 \ar[dr]_{\varphi'}  \ar[dl]^{\varphi}& \\
R & & R'}
}\label{art6-eq3.1.1}
\end{equation}
of surjective\pageoriginale morphisms beween compact Riemann surfaces satisfying the following conditions (a), (b), (c):
\begin{itemize}
\item[(a)] \textit{The degrees of morphisms indicated by parallel arrows are equal.}

\item[(b)] \textit{Let $F$, $F'$ be the smallest Galois coverings of $R$, $R'$ containing $f$, $f'$ as subcoverings, respectively. Then $F$ and $\varphi$, $F'$ and $\varphi'$, are both linearly disjoint.}

\item[(c)] \textit{The vertical coverings $f$, $f'$ and $f^0$ are unramified.}
\end{itemize}

The degree of the vertical coverings is called \textit{the degree of the covrring} \eqref{art6-eq3.1.1}. Equivalence of two such coverings is defined by a commutative diagram connecting the two covering systems by three isomorphisms. For example, if $\epsilon^0$ is an automorphism of $R^{\ast^0}$ commuting with $f^0$, then replacing $\varphi^\ast$ by  $\varphi^\ast \circ \epsilon^0$ (and leaving all others fixed) only gives an equivalent covering. In fact, by (b), there is some automorphism $\epsilon$ of $R^\ast$ commuting with $f$, such that $\varphi^\ast \circ \epsilon^0 = \epsilon \circ \varphi^\ast$. But then, it is clear that the new covering is equivalent to the old one. \textit{Up to equivalence, giving an unramified covering \eqref{art6-eq3.1.1} is the same thing as giving a pair $\{f, f'\}$ of unramified coverings $f: R^\ast \longrightarrow R$, $f' : R^{\ast'} \longrightarrow R'$ satisfying (b), for which the fiber products $\fprod{R^\ast}{R^0}{R}$ and $\fprod{R^0}{R^{\ast'}}{R'}$ are isomorphic as coverings of $R^0$.}
(These products are \textit{connected} by the linear disjointness, and \textit{non-singular} by the unramifiedness of $f$, $f'$; so that they are also compact Riemann surfaces.)
\begin{equation*}
\vcenter{
\xymatrix@R=-0.05cm@C=0.9cm{
& \fprod{R^\ast}{R^0}{R} \ar[dddr] \ar[dl]  & \simeq & \fprod{R^0}{R^{\ast}}{R'} \ar[dr] \ar[dddl] & \\
R^\ast\ar[dddr]_-f & & & & R^{\ast'}\ar[dddl]^-{f'}\\
& & & & & \\
& & R^0 \ar[dr] \ar[dl] & & \\
& R & & R' &
}}\tag*{(3.1.1$'$)}\label{art6-eq3.1.1'}
\end{equation*}
By the above remark, the choice of $\simeq$ in \eqref{art6-eq3.1.1'} does not affect the equivalence class.

\begin{defi*}
The system $\{R \xleftarrow{\varphi} R^0 \xrightarrow{\varphi'} R'\}$ will be called `simply-connected, if it has no other unramified covering than that of degree one.
\end{defi*}

\subsection{}\label{art6-subsec3.2}
Now let\pageoriginale $n$ be any positive integer with $p \nmid n$ and $\Delta_n$ be the principle congruence subgroup of level $n$ of the modular group $\Delta_1 = PSL_2 (\bZ)$ over $\bZ$. Put
\begin{gather*}
\Delta'_n  = 
\begin{pmatrix} 
p & 0\\
0 & 1
\end{pmatrix}^{-1}
\Delta_n
\begin{pmatrix} 
p & 0 \\
0 & 1
\end{pmatrix} = 
\left\{
\left.
\begin{pmatrix} 
a & p^{-1} & b\\
pc & d
\end{pmatrix}
\right| 
\begin{pmatrix} 
a & b \\
c & d
\end{pmatrix} \in 
\Delta_n
 \right\},\\
\Delta^0_n = \Delta_n \cap \Delta'_n = \left\{ \left. 
\begin{pmatrix} 
a & b \\
c & d
\end{pmatrix} \in \Delta_n \right| c \equiv 0 \; (\mod p)
 \right\}.
\end{gather*}
Then they define a system $\{\Delta_n \leftarrow \Delta^0_n \rightarrow \Delta'_n\}$ of fuchsian groups, the arrows indicating the inclusions. Note that $\Delta^0_n$ is of index $p+1$ in $\Delta_n$ and $\Delta'_n$. Let $\{R_n \xleftarrow{\varphi} R^0_n \xrightarrow{\varphi'} R'_n\}$ be the corresponding system of compact Riemann surfaces, \ie, $R_n$, $R'_n$, $R^0_n$ are the compactified quotients of the complex upper half plane by $\Delta_n$, $\Delta'_n$, $\Delta^0_n$; and $\varphi$, $\varphi'$ are the canonical coverings defined by the inclusions $\Delta^0_n \hookrightarrow \Delta_n$, $\Delta^0_n \hookrightarrow \Delta'_n$.

\setcounter{lemma}{1}
\begin{lemma}\label{art6-lem3.2}
For each positive integer $n$ with $p \nmid n$, the system $\{R_n \xleftarrow{\varphi} R^0_n \xrightarrow{\varphi'} R'_n \}$ is simply-connected.
\end{lemma}

Let $\Gamma_1 = PSL_2 (\bZ^{(p)})$ be the modular group over $\bZ^{(p)}$ and $\Gamma_n$ be the principal congruence subgroup of level $n$. The proof is based on the following properties (A), (B) of $\Gamma_n$.
\begin{itemize}
\item[(A)] $\Gamma_n$ is the free product of $\Delta_n$ and $\Delta'_n$ with  amalgamated subgroup $\Delta^0_n$.

\item[(B)] $\Gamma_n$ is normally generated by $\begin{pmatrix}
1 & n \\0 & 1\end{pmatrix}$ in $\Gamma_1$;  in particular, it is generated only by parabolic elements.
\end{itemize}

The property (A) was proved in our previous work. It is a corollary of the corresponding property of the local groups (\cite{art6-key8}, I, Ch. 2, \S 28, p. 111, or a more full-fledged geometric exposition in \cite{art6-key15}). The property (B) was proved by Mennicke \cite{art6-key12} and Serre \cite{art6-key16}. It is equivalent to the congruence subgroup property of $\Gamma_1$ modulo the local congruence subgroup property.

\subsection{Proof of Lemma \ref{art6-lem3.2}}\label{art6-subsec3.3}
Write
$$
\left\{R \xleftarrow{\varphi} R^0 \xrightarrow{\varphi'} R' \right\} \text{~~ and ~~} \left\{\Delta \longleftarrow \Delta^0 \longrightarrow \Delta' \right\}
$$
instead of \pageoriginale of writing with suffix $n$. Suppose that there is an unramified covering \eqref{art6-eq3.1.1} of degree $m$. Then there is a corresponding commutative diagram of inclusions of fuchsian groups
\setcounter{equation}{0}
\begin{equation}
\vcenter{
\xymatrix@R=-0.05cm@C=1cm{
& \Delta^{\ast 0} \ar[dr] \ar[dl] \ar[ddd] & \\
\Delta^\ast \ar[ddd] &&  \Delta^{\ast'} \ar[ddd]\\
& & &\\
& \Delta^0 \ar[dr]  \ar[dl] & \\
\Delta & & \Delta'}
}\label{art6-eq3.3.1}
\end{equation}
with 
\begin{gather}
(\Delta: \Delta^\ast) = (\Delta' : \Delta^\ast) = (\Delta^0 : \Delta^{\ast 0}) = m, \label{art6-eq3.3.2}\\
\Delta^\ast \cdot \Delta^0 = \Delta, \quad \Delta^{\ast'} \cdot \Delta^0 = \Delta', \tag*{$|$\quad~}\\
\Delta^\ast \cap \Delta^0 = \Delta^{\ast'} \cap \Delta^0 = \Delta^{\ast 0}, \label{art6-eq3.3.3}\\
Pb(\Delta) = Pb (\Delta^\ast), \;Pb (\Delta') = Pb (\Delta^{\ast'}) , \;Pb (\Delta^0) = Pb (\Delta^{\ast 0}), \label{art6-eq3.3.4}
\end{gather}
where $Pb (\;)$ is the set of all parabolic elements of the group inside the parenthesis. The first two equalities of \eqref{art6-eq3.3.3} are the consequences of the condition (b), the rest of \eqref{art6-eq3.3.3} is the consequence of the first two equalities and the condition (a), and \eqref{art6-eq3.3.4} is a consequence of (c).

Now let $\Gamma^\ast$ be the subgroup of $\Gamma = \Gamma_n$ generated by $\Delta^\ast$ and $\Delta^{\ast'}$. We shall deduce from \eqref{art6-eq3.3.2}, \eqref{art6-eq3.3.3} and the property (A) of $\Gamma$ that 
\begin{equation}
(\Gamma: \Gamma^\ast ) = m, \label{art6-eq3.3.5}
\end{equation}
and from \eqref{art6-eq3.3.4} that 
\begin{equation}
Pb (\Gamma) = P b(\Gamma^\ast). \label{art6-eq3.3.6}
\end{equation}
But then, by the property (B) of $\Gamma$, \eqref{art6-eq3.3.6} would imply $\Gamma = \Gamma^\ast$, and hence $m =1$ by \eqref{art6-eq3.3.5}. So it remains to prove \eqref{art6-eq3.3.5} and \eqref{art6-eq3.3.6}. 

Let $1 = M_0, M_1, \ldots, M_p$ (\resp $1 = M'_0, M'_1, \ldots, M'_p$) be representatives of the coset spaces $\Delta^{\ast 0} /\Delta^\ast$ (\resp $\Delta^{\ast 0} / \Delta^{\ast'}$). Then by \eqref{art6-eq3.3.3}, they are also representatives of $\Delta^0/ \Delta$ (\resp $\Delta^0/ \Delta'$). Since $\Gamma$ is generated by $\Delta$ and $\Delta'$, each element $\gamma$ of $\Gamma$ can be expressed in the form
\begin{equation}
\gamma = \delta_{0} M_{i_1} M'_{j_1} \ldots M_{i_r} M'_{j_r} \quad (\delta_0 \in \Delta^0, j_1, \ldots , i_r \neq 0). 
\label{art6-eq3.3.7}
\end{equation}
The set\pageoriginale of all those $\gamma \in \Gamma$ having an expression \eqref{art6-eq3.3.7} with $\delta_0 \in \Delta^{\ast 0}$ forms a subgroup of $\Gamma$, since $M_i$ and $M'_j$ belong to $\Delta^\ast$ and $\Delta^{\ast'}$ respectively. It is clear that this subgroup is $\Gamma^\ast$. Therefore, $\Delta^0 \cdot \Gamma^\ast  = \Gamma$; hence $(\Gamma : \Gamma^\ast) = (\Delta^0 : \Delta^0 \cap \Gamma^\ast)$. But \textit{by the property} (A) \textit{ of $\Gamma$, the expression \eqref{art6-eq3.3.7} is unique} (see Krosh \cite{art6-key10} II, for the general theorems on free products with amalgamations). Therefore, we have $\Delta^0 \cap \Gamma^\ast = \Delta^{\ast 0}$, which gives $(\Gamma : \Gamma^\ast) = (\Delta^0 : \Delta^{\ast 0}) =m$. Thus,  \eqref{art6-eq3.3.5} is settled.

To check \eqref{art6-eq3.3.6}, let $\gamma \in \Gamma$ be parabolic, and put $\gamma = \pm I + p^{-k}A (k \geqslant 1)$, where $I$ is the identity matrix and $A$ is a $\bZ$-integral matrix with $A^2=0$. Then $\gamma^{p^k} = \pm I + A \in PSL_2 (\bZ)$. Hence $\gamma^{p^k}$ belongs to $\Delta$ and hence to $\Delta^\ast$ by \eqref{art6-eq3.3.4}. Therefore, $\gamma^{p^k} \in \Gamma^\ast$. But for any parabolic element $\gamma$ of $\Gamma_1$, its order relative to any subgroup with finite index of $\Gamma_1$ is not divisible by $p$. In fact, by the above argument, $\gamma^{p^k} \in PSL_2 (\bZ)$, and hence $\gamma^{p^k}$ is conjugate to an integral power of $\begin{pmatrix}1 & 1 \\0 & 1\end{pmatrix}$. Therefore, $\gamma$ is conjugate to 
$\begin{pmatrix}
1 & b \\ 0 & 1 \end{pmatrix}$ with some $b \in \bZ^{(p)}$. But $\begin{pmatrix}
1 & b\\ 0 & 1
\end{pmatrix}$ is conjugate to its $p^2$-th power $\left(\text{by } \begin{pmatrix}
p^{-1} & 0\\ 0 & p
\end{pmatrix}\right)$; hence $\gamma$ is also conjugate to its $p^2$-th power $\gamma^{p^2}$. This gives the above assertion, and hence also that $\gamma \in \Gamma^\ast$. Therefore, \eqref{art6-eq3.3.6} is also settled. The lemma follows.


\subsection{}\label{art6-subsec3.4}
As for the covering \eqref{art6-eq3.1.1} of those systems obtained from the system of fuchsian groups $\{\Delta \leftarrow \Delta^0 \rightarrow \Delta'\} - \{\Delta_n \leftarrow \Delta^0_n \rightarrow \Delta'_n\}$, \textit{the linear disjointness of $F$ and $\varphi$ (\resp. $F'$ and $\varphi'$) follows automatically from the unramifiedness of $f$ (\resp. $f'$)}. In fact, let $\Delta^\ast$ be the fuchsian group corresponding to $R^\ast$, and $\Delta^{\ast\ast}$ be the intersection of all conjugates of $\Delta^\ast$ in $\Delta$. Then the unramifiedness of $f$ gives $Pb (\Delta) = Pb (\Delta^\ast)$; hence also $Pb(\Delta) = Pb (\Delta^{\ast\ast})$. But $Pb(\Delta^0) \subsetneq Pb(\Delta)$, as $\begin{pmatrix}
1&0\\ n&1
\end{pmatrix} \not\in \Delta^0$. In particular, $\Delta^{\ast \ast}$ is not contained in $\Delta^0$. But as is well known, there is no proper intermediate group between $\Delta$ and $\Delta^0$. (This is clear since $\Delta' / \Delta$ can be identified with the projective line over $F_p$ by $\begin{pmatrix}
a & b \\c & d 
\end{pmatrix} \rightsquigarrow dc^{-1} (\mod p)$, and $\Delta$ acts doubly transitively on this line as a group of linear fractional transforms.) Therefore, $\Delta^0 \bigdot \Delta^{\ast\ast} \Delta$, which implies the linear disjointness of $F$ and $\varphi$.


\subsection{}\label{art6-subsec3.5}
\textit{The general picture.}\pageoriginale  To clarify the general situation, we note the following. As in \S \eqref{art6-subsec3.2} , let $\Gamma_1 = PSL_2 (\bZ^{(p)})$, and put $\Delta_1 = PSL_2 (\bZ)$, $\Delta'_1 = \begin{pmatrix}
p &0\\
0&1
\end{pmatrix}^{-1} \Delta_1 
\begin{pmatrix}
p&0\\
0&1
\end{pmatrix}$ and $\Delta^0_1 = \Delta_1 \cap \Delta'_1$. Then, (i) $\Gamma_1$ is a free product of $\Delta_1$ and $\Delta'_1$ with amalgamated subgroup $\Delta^0_1$, and (ii) for any subgroup $\Gamma$ of $\Gamma_1$ with finite index, it holds that $\Delta^0_1  \cdot \Gamma = \Gamma_1$. (Since $\Gamma_1$ is dense in $PSL_2 (\bQ_p)$, $\bQ_p$  being the $p$-adic field, the topological closure of $\Gamma$ in $PSL_2 (\bQ_p)$ is of finite index in $PSL_2 (\bQ_p)$. But since $PSL_2(\bQ_p)$ is an infinite simple group, it has no non-trivial subgroups with finite indices. Therefore, $\Gamma$ is \text{dense} in $PSL_2 (\bQ_p)$. This gives $\Delta^0_1 \bigdot \Gamma = \Gamma_1$.) From these two properties (i), (ii), it follows directly that the associateion
\begin{equation}
\Gamma \rightsquigarrow \{\Delta, \Delta'\} ; \; (\Delta = \Gamma \cap \Delta_1, \; \Delta' = \Gamma \cap \Delta'_1) 
\label{art6-eq3.5.1}
\end{equation}
gives a one-to-one correspondence between subgroups $\Gamma$ of $\Gamma_1$ with finite indices and the pairs $\{\Delta, \Delta'\}$ of subgroups $\Delta \subset \Delta_1$, \; $\Delta' \subset \Delta'_1$ with finite indices satisfying $\Delta^0_1 \bigdot \Delta = \Delta_1$, $\Delta^0_1 \bigdot \Delta' = \Delta'_1$ and $\Delta^0_1 \cap \Delta = \Delta^0_1 \cap \Delta'$. It is also easy to check, by the argument similar to that used in the proof of Lemma 3.1, that $\Gamma$ is a free product of $\Delta$ and $\Delta'$ with amalgamated subgroup $\Delta^0 = \Delta \cap \Delta'$, and that $(\Gamma_1 : \Gamma) =(\Delta_1 : \Delta) = (\Delta'_1: \Delta') = (\Delta^0_1: \Delta^0)$. We may call $\{\Delta, \Delta'\}$ \textit{the canonical generating pair of fuchsian groups for} $\Gamma$. For $\Gamma = \Gamma_n$, it is nothing but $\{\Delta_n, \Delta'_n\}$ defined in \S \ref{art6-subsec3.2}.

Now let $\{R \xleftarrow{\varphi} R^0 \xrightarrow{\varphi'} R'\}$ be the system of compact Riemann surfaces corresponding to $\{\Delta \leftarrow \Delta^0 \rightarrow \Delta'\}$. Then there is a canonical covering 
\setcounter{equation}{1}
\begin{equation}
\vcenter{
\xymatrix{
R \ar[d]_-f & R^0\ar[r]^-{\varphi'}\ar[d]_-{f^0}\ar[l]_-{\varphi} & R' \ar[d]_-{f'}\\
R_1 & R^0_1 \ar[r]_-{\varphi'_1} \ar[l]^-{\varphi_1} & R'_1
}}
\textit{corresponding to }
\vcenter{
\xymatrix{
\Delta \ar[d] & \Delta^0\ar[r] \ar[d] \ar[l]& \Delta' \ar[d]\\
\Delta_1 & \Delta^0_1 \ar[r] \ar[l]& \Delta'_1
}}\label{art6-eq3.5.2}
\end{equation}
The covering \eqref{art6-eq3.5.2} satisfies the conditions (a), (b) of \S \ref{art6-subsec3.1}, and instead of (c), the following weaker condition:

(c$'$) \textit{The ramification\pageoriginale index of $f^0$ at each non-cuspidal point $P$ of $R^0_1$ is a factor of the ramification index at $P$ of the covering $\sH \to \Delta^0_1 / \bH \hookrightarrow R^0_1$ of $R^0_1$ by the upper half plane $\bH$}.

It follows immediately from the above remarks that \textit{the functor}
\begin{equation}
\Gamma \rightsquigarrow \{R \xleftarrow{\varphi} R^0 \xrightarrow{\varphi'} R'\} \label{art6-eq3.5.3}
\end{equation}
\textit{gives a categorical equivalence between subgroups with finite indices of $\Gamma_1$ and those coverings of the system $\left\{R_1 \xleftarrow{\varphi_1} R^0_1  \xrightarrow{\varphi'_1} R'_1\right\}$ satisfying} (a), (b), (c$'$).

Finally, let $\Gamma^\ast$ denote the subgroup of $\Gamma$ generated by $Pb(\Gamma)$. It is of finite index, as $\Gamma$ contains some $\Gamma_n$ and $\Gamma^\ast_n = \Gamma_n$. If $\Gamma$ is torsion-free, $\Gamma^\ast$ corresponds to the maximum unramified covering of $\{R \xleftarrow{\varphi} R^0 \xrightarrow{\varphi'} R'\}$ so that Lemma 3.2 \textit{is valied for $\Gamma$ if and only if $\Gamma^\ast = \Gamma$.} As an example, let $n >1$  and $\Gamma \supset \Gamma_n$ be that group with which $\Gamma / \Gamma_n$ is the center of $\Gamma_1 / \Gamma_n$. Then $\Gamma$ is torsion-free, $\Gamma^\ast = \Gamma_n$, and $\Gamma / \Gamma_n$ is an elementary 2-group of rank $r$, where $r$ is the number of distinct prime factors of the numerator of $n/2$, so that $\left\{R_n \xleftarrow{\varphi_n} R^0_n \xrightarrow{\varphi'_n} R'_n\right\}$ is the maximum unramified covering of $\left\{R \xleftarrow{\varphi} R^0 \xrightarrow{\varphi'} R' \right\}$ with the elementary 2-group of rank $r$ as the Galois group.

\section{The characteristic $p$ system $\left\{X_n \xleftarrow{\psi} X^0_n \xrightarrow{\psi'} X'_n \right\}$}\label{art6-sec4}
In \S \ref{art6-sec3}, we gave a geometric interpretation of the congruence subgroup property of $PSL_2 (\bZ^{(p)})$ as the simply-connectedness of the system  $\left\{R_n \xleftarrow{\varphi} R^0_n \xrightarrow{\psi'} R'_n \right\}$ of three compact Riemann surfaces (for all $n$ with $p \nmid n$). In this section, we shall give another geometric interpretation, an interpretation of some arithmetic condition in characteristic $p$. It is based on a simple principle, which makes it possible to reformulate our theorem in geometric terms.

\subsection{}\label{art6-subsec4.1}
Let $q$ be\pageoriginale any positive power of $p$, $F_{q^2}$ be the finite field with $q^2$ elements, and $F$ be its algebraic closure. \textit{Suppose given an algebraic curve $X$ over $F_{q^2}$ and a specified set $S$ of $F_{q^2}$-rational points of $X$; assumed that $X$ is complete, non-singular and absolutely irreducible, and that $S$ is non-empty.} Then, starting from such a pair of $X$ and $S$ we can construct a system.
\setcounter{equation}{0}
\begin{equation}
\left\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} \right\}
\label{art6-eq4.1.1}
\end{equation}
of three algebraic curves $X$, $X'$, $X^0$ and surjective morphisms $\psi$, $\psi'$ of degree $q +1$, as follows. First, $X'$ is the conjugate of $X$ over $F_q$. Then, there are two $q$-th power morphisms $\pi : X \to X'$ and $\pi': X ' \to X$. Let $\Pi, \Pi'$ be their graphs, both taken on $X \times X'$;
\begin{equation}
\Pi = \{(x, x^q) | x \in X\}, \; \Pi' = \{(x'^q, x') | x' \in X'\}. 
\label{art6-eq4.1.2}
\end{equation}
Observe that the intersection $\Pi \cap \Pi'$ consists of all points of $X \to X'$ of the form $(x, x')$, where $x$, $x'$ are $F_{q^2}$-rational points of $X$, $X'$ that are mutually conjugate over $F_q$. Put
\begin{equation}
S^0 = \{(x, x') \in \Pi \cap \Pi' | x \in S\}.\label{art6-eq4.1.3}
\end{equation}
Each of the two curves $\Pi$, $\Pi'$ is a complete non-singular absolutely irreducible curve lying on $X \times X'$, and they intersect \textit{transversally} at each point of $\Pi \cap \Pi'$. The union $\Pi \cup \Pi'$ can be regarded as a reducible curve having ordinary double points arising from these intersections. Denote by $\Pi + \Pi'$ the \textit{disjoint} sum, and by $\iota : \Pi + \Pi' \to \Pi \cup \Pi'$  the canonical covering. Then $\iota$ separates all double points of $\Pi\cup \Pi'$. Subcoverings of $\iota$ are those which separate \textit{some parts} of them. Let 
\begin{equation}
\iota (S^0) : \Pi {\displaystyle{\mathop{+}_{S^0}}} \Pi'
\label{art6-eq4.1.4}
\end{equation}
be that subcovering of $\iota$ defined by the condition that the double points of $\pi  {\displaystyle{\mathop{+}_{S^0}}} \Pi'$ are precisely the points lying on $S^0$. It is obtained by separating precisely those double points of $\Pi \cup \Pi'$ belonging to the \textit{complement of} $S^0$ in $\Pi \cap \Pi'$. Put
\begin{equation}
X^0 = \Pi  {\displaystyle{\mathop{+}_{S^0}}} \Pi', \quad 
\begin{cases}
\psi & = pr_1 \circ \iota (S^0),\\
\psi' & = pr_2 \circ \iota (S^0),
\end{cases}
\label{art6-eq4.1.5}
\end{equation}
where\pageoriginale $pr_i(i = 1, 2)$ is the projection to the $i$-th factor of $X \times X'$. Then $\psi: X^0 \to X$, $\psi' : X^0 \to X'$ are surjective morphisms of degree $q+1$. Note that $\psi | \Pi \; \psi' $ are isomorphisms and that $\psi |\Pi'$, $\psi' |\Pi$ are purely inseparable with degree $q$. The system \eqref{art6-eq4.1.1} is thus constructed.

\subsection{}\label{art6-subsec4.2}
Now consider an \textit{unramified} covering $f : Y \to X$ of $X$. Here, $Y$ is an algebraic curve over $F_{q^2}$ assumed to be complete nonsingular and irreducible over $F_{q^2}$ (but may not be absolutely irreducible), and $f$ is assumed to be defined over $F_{q^2}$. We shall be concerned with the following conditions (A) and (A$'$) on $X$, $S$, $Y$ and $f$.

(A) \textit{All points of $Y$ lying on $S$ are $F_{q^2}$-rational points.}

If (A) is satisfied, $Y$ has at least one $F_{q^2}$-rational point and such a point of $Y$ must lie on all absolute irreducible components of $Y$. But since $Y$ is non-singular, this implies that $Y$ \textit{must be absolutely irreducible}. A slightly weaker condition is the following:

(A$'$) \textit{Each absolute irreducible component of $Y$ has an $F_{q^2}$-structure satisfying} (A).

More precisely, let $Y_1$ be an absolute irreducible component of $Y$. Then (A$'$) imposes that there is an algebraic curve $Y_2$ over $F_{q^2}$ and an isomorphism $\alpha : Y_1 \tilde{\longrightarrow} Y_2$ over $F$ such that $f \circ \alpha^{-1} : Y_2 \to X$  satisfies (A). Since all absolute irreducible components of $Y$ are mutually conjugate over $F_{q^2}$, it is satisfied all \textit{all} components if so for \textit{one} component. If (A$'$) is satisfied, all absolute irreducible components of $Y$ must be isomorphic (over $F$). A covering $f$ is called a \textit{constant field extension} if its restriction to each absolute irreducible component is an isomorphism (over $F$). Such a covering satisfies (A$'$), and it is essentially the covering of $X$ by $R_{F_{q^2}m/ F_{q^2}} (X)$, $m$ being the number of absolute irreducible components of $Y$. The following proposition is an elementary exercise.

\begin{subprop}\label{art6-subprop4.2.1}
The condition (A$'$) is equivalent to the existence of an automorphism $\epsilon$ of $Y$ defined over $F_{q^2}$ satisfying the following conditions: (i) $f \circ \epsilon = f$, (ii) $\epsilon y = y^{q^2}$ for all $y \in Y$ with $f(y) \in S$.
\end{subprop}

It is\pageoriginale is clear that such $\epsilon$ is unique and that (A) is equivalent to $\epsilon =1$.

We shall give some geometric interpretations of the conditions (A), (A$'$). For this purpose, let $S_Y$ be the set of all $F_{q^2}$-rational points of $Y$ lying on $S$;
$$
S_Y = \{y \in Y | y^{q^2} = y, f (y) \in S\}.
$$
If $S_Y$ is non-empty, $Y$ must be absolutely irreducible. Define $\pi_Y$, $\pi'_Y$, $\Pi_Y$, $\Pi'_Y$, $S^0_Y$ and the system
\setcounter{equation}{1}
\begin{equation}
\left\{Y \xleftarrow{\psi_Y} Y^0 \xrightarrow{\psi' Y} Y' \right\}
\label{art6-eq4.2.2}
\end{equation}
in the same manner as in \S \ref{art6-subsec4.1} starting from $Y$ and $S_Y$. (If $Y$ is not absolutely irreducible and hence without $F_{q^2}$-rational points, then $\Pi_Y$ and $\Pi'_Y$ do not intersect on $Y \times Y'$, and $Y^0$ is the disjoint sum of these two graphs.) Let $f' : Y' \longrightarrow X'$ be the conjugate of $f$ over $F_q$. Then $f' \circ \pi_Y = \pi \circ f$ and $f \circ \pi' \circ f'$. Therefore, $(f \times f') : Y \times Y' \to  X \times X'$ maps $\Pi_Y$ into $\Pi$, and $\Pi'_Y$ into $\Pi'$, thus inducing the morphisms
\begin{equation}
\left.
\begin{array}{c}
f^{01} : \Pi_Y \to \Pi, \quad f^{02} : \Pi'_Y \to \Pi',\\
(y, y^q) \rightsquigarrow (x, x^q) \quad (y'^q, y') \rightsquigarrow (x'^q, x')
\end{array}
\right\}
\label{art6-eq4.2.3}
\end{equation}
where $x = f(y)$ and $x' = f'(y')$. They are unramified coverings since $f^{01}$ corresponds to the unramified covering $f: Y \to X$ \textit{via} the two isomorphisms $pr_1 : \Pi_Y \tilde{\longrightarrow} Y$, $pr_1 : \Pi \tilde{\longrightarrow} X$. (Similar for $f^{02}$.) By the definition of $S_Y$, the points $(y, y^q) \in \Pi_Y$ and $(y'^q, y') \in \Pi'_Y$ intersect on $Y^0$ if and only if $y' = y^q$, $y = y'^q$ and $f(y) \in S$. But in this case, $f^{01} ((y, y^q))$ and $f^{02} ((y'^q, y'))$ intersect on $X^0$. Therefore, there is q unique morphism, $f^0: Y^0 \to X^0$ such that $f^0 | \Pi_Y = f^{01}$ and $f^0| \Pi'_Y = f^{02}$. The diagram
\begin{equation}
\vcenter{
\xymatrix@R=0.5cm@C=1.5cm{
& Y^0 \ar[dr]^-{\psi'_Y} \ar[dl]_-{\psi_Y} \ar[ddd]_-{f^0} & \\
Y \ar[ddd]_-f && Y' \ar[ddd]_-{f'}\\
& & &\\
& X^0 \ar[dr]_-{\psi'}  \ar[dl]^-{\psi} & \\
X & & X'}
}\label{art6-eq4.2.4}
\end{equation}
is commutative.

\setcounter{subprop}{4}
\begin{subprop}\label{art6-subprop4.2.5}
The condition\pageoriginale (A) is equivalent to that all points of $Y^0$ lying on the double points of $X^0$ are double points, and equivalent also to that $f^0$ is \'etale.
\end{subprop}

\begin{proof}
The double points of $X^0$ correspond to the points of $S^0$. Take $(x, x') \in S^0$ and let $y_1, \ldots, y_m (m = \deg f)$ be the points of $Y$ lying on $x$. We can assume that $y_1, \ldots, y_r$ are $F_{q^2}$-rational points and $y_{r+1}, \ldots, y_m$ are not $(0 \leqslant r \leqslant m)$. Then the points of $\Pi_Y$ (\resp. $\Pi'_Y$) lying on $(x, x')$ by $f^{01}$ (\resp. $f^{02}$) are $(y_i, y^q_i) (1 \leqslant i \leqslant m)$ (\resp. $(y_i, y^{q-1}_i)$ $(1 \leqslant i \leqslant m)$). Therefore, the points of $Y^0$ lying on $(x, x')$ by $f$ are:
\begin{itemize}
\item[(a)~] \textit{the double points} \quad $(y_i, y^q_i) = (y_i, y^{q^{-1}}_i)$ \hfill$(1\leqslant i \leqslant r)$,

\item[(b)~] \textit{the simple points} \quad $(y_j, y^q_j)$ \hfill $(r + 1 \leqslant  j \leqslant m)$,

\item[(b$'$)] \textit{the simple points} \quad $(y_j, y^{q-1}_j)$ \hfill$(r+1 \leqslant j \leqslant m)$.
\end{itemize}
This proves the first equivalence. On the other hand, $f^0$ is always unramified, and the condition $r =m$ is equivalent to the flatness of $f^0$; whence the second equivalence. q.e.d.
\end{proof}

\setcounter{sublemma}{5}
\begin{sublemma}\label{art6-sublem4.2.6}
Let $f : Y \to X$ and $g : Z \to X$ be two unramified coverings of $X$ over $F_{q^2}$ by irreducible complete non-singular curves over $F_{q^2}$, and $g' : Z' \to X'$ be the conjugate of $g$ over $F_q$. Then
$$
\fprod{Y}{X^0}{X} \simeq \fprod{X^0}{Z'}{X'} \text{ over } X^0
$$
holds if and only if (i) $Y \simeq Z$ over $X$ and (ii) $f$ satisfies (A$'$).
\end{sublemma}

\begin{proof}
Look at the left half of the diagram \eqref{art6-eq4.2.4}. Let $\alpha : Y^0 \to \fprod{Y}{X^0}{X}$ be the canonical morphism, \ie, the morphism defined by $pr_1 \circ \alpha = \psi_Y$ and $pr_2 \circ \alpha = f^0$. Then $\alpha$ is an injective isomorphism on each irreducible component $\Pi_Y$, $\Pi'_Y$ of $Y^0$ and produces \textit{new double points} on the image, by $\alpha((y_j, y^q_j)) = \alpha ((y_j, y_j^{q-1})) (r + 1 \leqslant j \leqslant m)$ for each $(x, x') \in S^0$. Therefore $\fprod{Y}{X^0}{X}$ is the sum of $\Pi_Y$ and $\Pi'_Y$ where $(y, y^q) \in \Pi_Y$ and $(y, y^{q-1}) \in \Pi'_Y$ intersect transversally for each $y \in Y$ with $f (y) \in S$. Similarly, $\fprod{X^0}{Z'}{X'}$ is the sum of $\Pi_Z$ and $\Pi'_Z$ where  $(z,z^q) \in \Pi_Z$ and $(z^{q^2}, z^q) \in \Pi_Z$ intersect transversally for each\pageoriginale $z \in Z$ with $g(z) \in S$. Suppose that there is an isomorphism $\delta: \fprod{Y}{Z^0}{X} \tilde{\longrightarrow} \fprod{X^0}{Z'}{X'}$ over $X^0$. Then $\delta$ induces an isomorphism $\Pi_Y \tilde{\longrightarrow} \Pi_Z$ over $\Pi$ and $\Pi'_Y \tilde{\longrightarrow} \Pi'_Z$ over $\Pi'$; consequently an isomorphism $\epsilon_1 : Y \tilde{\longrightarrow} Z$ over $X$ and $\epsilon'_2 : Y' \tilde{\longrightarrow} Z'$ over $X'$. Let $\epsilon_2$ be the conjugate of $\epsilon'_2$ over $F_q$. Now take any $y \in Y$ with $f(y) \in S$. Then $\delta$ maps $(y, y^q)$ to $(y^{\epsilon_1}, (y^{\epsilon_1})^q)$ and $(y, y^{q^{-1}})$ to $(y^{\epsilon_2}, (y^{\epsilon_2})^{q^{-1}})$. Therefore, $(y^{\epsilon_1}, (y^{\epsilon_1})^q)$ and $(y^{\epsilon)2}, (y^{\epsilon_2})^{q^{-1}})$ must coincide on $\fprod{X^0}{Z'}{X'}$. We obtain $y^{\epsilon_2} = (y^{\epsilon_1})^{q^2}$. Therefore, $\epsilon = \epsilon_2 \epsilon^{-1}_1$ satisfies the conditions (i), (ii) of Prop. \ref{art6-subprop4.2.1}; hence $f$ satisfies (A$'$). Conversely, if there are isomorphisms $\epsilon: \fprod{Y}{X^0}{X} \tilde{\to} \fprod{X^0}{Z'}{X'}$ over $X^0$ by combining $\epsilon_1 = \epsilon^{-1} \epsilon_2$ and $\epsilon_2$ in the above way. (Since the intersections are transversal, the morphisms of two irreducible components give rise to a morphism of the sum if and only if they coincide on the interesecting points.) q.e.d.
\end{proof}

\begin{coro*}
The condition (A) is equivalent to 
\setcounter{equation}{6}
\begin{equation}
Y^0 \simeq \fprod{Y}{X^0}{X} \simeq \fprod{X^0}{X'}{Y'} \quad \text{over } \;X^0,
\label{art6-eq4.2.7}
\end{equation}
and (A$'$) is equivalent to
\begin{equation*}
\fprod{Y}{X^0}{X} \simeq \fprod{X^0}{Y'}{X'} \quad \text{over } \; X^0.\tag{4.2.7$'$}
\label{art6-eq4.2.7'}
\end{equation*}
\end{coro*}

\begin{proof}
The second assertion follows immediately from the lemma. That (A) implies \eqref{art6-eq4.2.7} is obvious by the proof of the lemma (the explicit constructions of the fiber products). Conversely, since $\fprod{Y}{X^0}{X}$ is \'etale over $X^0$ (being a base change of an \'etale $X$)-scheme $Y$, with $X$, $Y$ noetherian; or as is clear by its explicit presentation given above), \eqref{art6-eq4.2.7} implies that $Y^0$ is \'etale over $X^0$, which implies (A) by Prop. \ref{art6-subprop4.2.5} q.e.d.
\end{proof}

\subsection{}\label{art6-subsec4.3}
Now, let $K$ be any finite extension of $K_1 = F_{p^2} (j)$ contained in $K_\infty$ (\S \ref{art6-subsec1.1}), and $X$ be a complete non-singular model of $K$ over $F_{p^2}$. \textit{Let $S$ be the set of all supersingular prime divisors of $K$.} Since the\pageoriginale elements of $S$ are of degree one over $F_{p^2}$ (\S \eqref{art6-subsec1.3}), they can be regarded as $F_{p^2}$-rational points of $X$. Define the system $\left\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} X' \right\}$ as in \S \eqref{art6-subsec4.1}, starting from these $X$ and $S$. When $K= K_n$, we shall denote the system by
\begin{equation}
\left\{X_n \xleftarrow{\psi} X^0_n \xrightarrow{\psi'} X'_n \right\}.
\label{art6-eq4.3.1}
\end{equation}
Then by \S \ref{art6-subsec4.2} and by the Corollary of Lemma \ref{art6-sublem4.2.6}, our Main Theorem [MT 2]$_n$ is equivalent to the following:

(MT 5)$_n$. \textit{Let $f: Y \to X_n$ be an unramified covering of $X_n$ over $F_{p^2}$ by a complete non-singular irreducible curve $Y$ over $F_{p^2}$. Let $f' : Y' \to X'_n$ be the conjugate of $f$ over $F_p$, and suppose that there is an isomorphism}
\begin{equation}
\fprod{Y}{X^0_n}{X_n} \simeq \fprod{X^0_n}{Y'}{X'_n} \text{ over} X^0_n. \label{art6-eq4.3.2}
\end{equation}
\textit{Then $f$ must be a constant field extension (\ie, an isomorphism on each absolute irreducible component).}

We shall prove our theorem in this form.

Note that if $n$ belongs to the ideal $n_0 \bZ$ of Prop 1.3.1$'$, so that all $F_{p^2}$-rational points of $X_n$ are supersingular, then we have $X^0_n = \Pi \cup \Pi'$ 
for the ordinary union taken on $X_n \times X'_n$.

\subsection{Supplement}\label{sec6-subsec4.4}
\'Etale coverings and simply-connectedness of $\left\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} X' \right\}$.

In general, let $\left\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} X' \right\}$be as in \S \ref{art6-subsec4.1}, and
\setcounter{equation}{0}
\begin{equation}
\vcenter{
\xymatrix{
Y \ar[d]_-f & W\ar[d]_-h\ar[r]\ar[l] & Y'\ar[d]_-{f'}\\
X & X^0 \ar[r]_{\psi'} \ar[l]^{\psi} & X'
} }
; Y, Y' \textit{ irreducible over } F_{q^2};
\label{art6-eq4.4.1}
\end{equation}
be a commutative\pageoriginale diagram of surjective morphisms of complete algebraic curves, all defined over $F_{q^2}$. It will be called \textit{an \'etale covering of degree $m$ of}  $\left\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} \right\}$, if the three vertical morphisms $f$, $f'$, $h$ are \'etale coverings (finite \'etale morphisms) of the same well-defined degree $m$. Since $X, X'$ are $non-singular$, $f$, $f'$ are \'etale if and only if they are unramified. If \eqref{art6-eq4.4.1} is \'etale, the canonical morphisms $W \to \fprod{Y}{X^0}{X}$ and $W \to \fprod{X^0}{Y'}{X'}$ must be isomorphisms over $X^0$, so that 
\begin{equation}
\fprod{Y}{X^0}{X} \simeq \fprod{X^0}{Y'}{X'} \text{ over} X^0. 
\label{art6-eq4.4.2}
\end{equation}
Conversely, if $f, f'$ are unramified coverings of $X$, $X'$ with which \eqref{art6-eq4.4.2} holds, then we can construct an \'etale covering \eqref{art6-eq4.4.1} by putting $W = \fprod{Y}{X^0}{X}$. (Equivalence of two \'etale coverings of $\{ X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} X'\}$ is defined in the natural way, so that the choice of isomorphisms of \eqref{art6-eq4.4.2} does not affect the equivalence class; see \S \ref{art6-subsec3.1} for a similar argument. Note also that the linear disjointness condition, the condition (b) in \S \ref{art6-subsec3.1}, is automatically satisfied for the \'etale coverings of $\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} X'\}$). Thus, up to equivalence, giving an \'etale covering of $\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} X'\}$ is the same thing as giving a pair of unramified coverings $\{f, f'\}$ satisfying \eqref{art6-eq4.4.2}. In view of Lemma \ref{art6-sublem4.2.6}, we can assume that $f': Y' \to X'$ is the conjugate of $f$ over $F_q$. Therefore, \textit{\'etale coverings of $\{X \xleftarrow{\psi} X_0 \xrightarrow{\psi'}X'\}$ and unramified coverings of $X$ satisfying (A$'$) are equivalent notions} (there is a categorical equivalence between them). Each \'etale covering \eqref{art6-eq4.4.1} defines the automorphism $\epsilon$ of $Y$ over $X$, which may be called \textit{the twist of}  this covering. Then, \textit{\'etale coverings of $\{X \xleftarrow{\psi} X^0\xrightarrow{\psi'} X'\}$ without twist and unramified coverings of $X$ satisfying (A) are also the equivalent notions.} 

One may define the \textit{simply-connectedness of} $\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} X'\}$ as follows, that it is simply-connected if the only \'etale coverings are those\pageoriginale with which the vertical coverings are isomorphisms on each absolute irreducible component. In these terms, our Main Theorem can also be stated as:

\medskip
\noindent
[MT 6]$_n$. \textit{The system $\{X_n \xleftarrow{\psi} X^0_n \xrightarrow{\psi'} X'_n\}$ is simply-connected.}

\section{The congruence relation.}\label{art6-sec5}
In this section we shall present and prove one natural version of the congruence relation.\footnote{\cf the previous versions \cite{art6-key3}, \cite{art6-key17}, \cite{art6-key6}, \cite{art6-key1}, \cite{art6-key18}.}


\subsection{}\label{art6-subsec5.1}
Let $p$ be the fixed prime number, and $n$ be a positive integer not divisible by $p$. Let $\sW_n$ be the group of complex $n$-th roots of unity, put $\sW_\infty = \bigcup\limits_{p \nmid n} \sW_n$, and consider the cyclotomic extension $\sF = \bQ (\sW_\infty)$ over the rational number field $\bQ$. Let $\sF_p$ be the decomposition field of $p$ in $\sF$. Then $\sF = \sF_p (\sW_\infty)$, and the field $\sF_p$ satisfies the condition of \S \ref{art6-subsec1.1} for $F_p$. Let $\sF_{p^m}(m \geqslant 1)$ be the unique extension of $\sF_p$ of degree $m$ in $\sF$. Let
\setcounter{equation}{0}
\begin{equation}
\omega^{\bC} : \sW_\infty \tilde{\longrightarrow} \underrightarrow{\lim} \bZ/n 
\label{art6-eq5.1.1}
\end{equation}
be \textit{the standard isomorphism} that maps $\exp (2 \pi i a /n)$ to $a (\mod n)$ for each $a$, $n$.

On the other hand, let $F_p$ be the prime field of characteristic $p$, $F$ be its algebraic closure, $W_n$ be the group of $n$-th roots of unity in $F$, and $W_\infty = \bigcup\limits_{p \nmid n} W_n$, so that $F = F_p (W_\infty)$ (and in fact $W_\infty = F^\times$). Then each place $\sF \to F$ maps $\sW_\infty$ isomorphically onto $W_\infty$, and there are precisely as many places $\sF \to F$ as elements of the Galois group $G (\sF/ \bQ)$ (and as many equivalence classes of places as elements of $G\sF_p/\bQ)$). since the canonical homomorphism $G(\sF/\bQ) \to \Aut \sW_\infty$ is a surjective isomorphism, we see that there are precisely as many places $\sF\to F$ as isomorphism $\sW_\infty \simeq W_\infty$. Each isomorphism $\sW_\infty \tilde{\longrightarrow} W_\infty$ determines \textit{via} $\omega_\bC$ an isomorphism $W_\infty \tilde{\longrightarrow} \underrightarrow{\lim} \bZ / n$, so that places $\sF \to F$ and isomorphisms $W_\infty \tilde{\longrightarrow} \underrightarrow{\lim} \bZ/n$ are in a canonical one-to-one correspondence. We shall fix
\begin{equation}
\omega : W_\infty  \tilde{\longrightarrow} \underrightarrow{\lim} \bZ/ n,
\label{art6-eq5.1.2}
\end{equation}
and the\pageoriginale corresponding place
\begin{equation}
pl:  \sF \to F. 
\label{art6-eq5.1.3}
\end{equation}
Let $\fz$ be the valuation ring of \eqref{art6-eq5.1.3} and put $\fz_{p^m} = \fz \cap \sF_{p^m}$. 

Now let $\Gamma$ be any subgroup of $\Gamma_1 = PSL_2 (\bZ^{(p)})$ with finite index, and $\{\Delta, \Delta'\}$ be the canonical generating pair of fuchsian groups for $\Gamma$ (\S \eqref{art6-subsec3.5}), \ie,
\begin{equation}
\Delta = \Gamma \cap PSL_2 (\bZ), \quad \Delta' = \Gamma \cap 
\begin{pmatrix}
p &0\\
0 & 1
\end{pmatrix}^{-1}
PSL_2  (\bZ) 
\begin{pmatrix}
p&0\\
0&1
\end{pmatrix}\label{art6-eq5.1.4}
\end{equation}
Put $\Delta^0 = \Delta \cap \Delta'$, and let $\{R \xleftarrow{\varphi} R^0 \xrightarrow{\varphi'} R'\}$ be the system of compact Riemann surfaces corresponding to $\{\Delta \leftarrow\Delta^0 \to \Delta'\}$. On the other hand, let $K$ be the finite extension of $K_1 = F_{p^2} (j)$ contained in $K_\infty$ that corresponds to $\Gamma$ by an injective isomorphism $\iota: \Gamma_1 \hookrightarrow G (K_\infty/K_1)$ belonging to $\omega$ (see \S \ref{art6-subsec1.1}; recall that $\iota$ is determined by $\omega$ up to inner automorphisms of $G(K_\infty/K_1)$, so that $K$ is determined up to isomorphisms over $K_1$). Take a complete non-singular model $X$ of $K$, let $X'$ be its conjugate over $F_p$, and let $X^0$ be the sum of $\Pi$ and $\Pi'$ \textit{with precisely the supersingular crossings,}  where $\Pi$, $\Pi'$ are the graphs on $X \times X'$ of the $p$-th power morphisms $X \to X'$, $X' \to X$, respectively (see \S \ref{art6-subsec4.1}, \S \ref{art6-eq4.3}). Let $\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} X'\}$  be the  system of $F_{p^2}$-curves thus defined. If $\Gamma = \Gamma_n$, the principal congruence subgroup of level $n$, then the systems $\{R \xleftarrow{\varphi} R^0 \xrightarrow{\varphi'} R'\}$ and $\{X \xleftarrow{\psi} X^0 \xrightarrow{\psi'} X'\}$ are nothing but $\{R_n \xleftarrow{\varphi} R^0_n \xrightarrow{\varphi'} R'_n\}$ and $\{X_n \xleftarrow{\psi} X^0_n \xrightarrow{\psi'} X'_n\}$ defined in \S \ref{art6-subsec3.2} and \S \ref{art6-subsec4.3}, respectively.

\begin{theorem*}[(Congruence relation)~]
There exists a system $\left\{\sX \xleftarrow{\Psi}\sX^0 \xrightarrow{\Psi'} \sX' \right\}$ of $\fz_{p^2}$-schemes which are proper over $\fz_{p^2}$, and $\fz_{p^2}$-morphisms $\Psi$, $\Psi$', such that 
\begin{equation*}
\left\{\sX \xleftarrow{\Psi}\sX^0 \xrightarrow{\Psi'}  \sX' \right\} \bigotimes_{\fz_{p^2}} \bC \simeq \left\{R \xleftarrow{\varphi} R^0 \xrightarrow{\varphi'}  R' \right\}
\tag{5.1.5 $\bC$}\label{art6-eq5.1.5C}
\end{equation*}
(as systems of complex algebraic curves).

\noindent
and\pageoriginale 
\begin{equation*}
\left\{\sX \xleftarrow{\Psi}\sX^0 \xrightarrow{\Psi'}  \sX' \right\} \bigotimes_{\fz_{p^2}} F_{p^2} \simeq \left\{X \xleftarrow{\varphi} X^0 \xrightarrow{\varphi'}  X' \right\}
\tag{5.1.5 $p$}\label{art6-eq5.1.5p}
\end{equation*}
where the first tensoring is with respect to the identity embedding $\fz_{p^2} \hookrightarrow \sF \hookrightarrow \bC$, and the second tensoring is with respect to the place \eqref{art6-eq5.1.3} that corresponds to the isomorphism \eqref{art6-eq5.1.2} used to define $X$.
\end{theorem*}

Here, we listed only those properties of the schemes that are necessary for our purpose. By our construction, the schemes $\sX$, $\sX^0$, $\sX'$ are also \textit{normal}, and $\sX$, $\sX'$ are mutually conjugate over $\fz_p$.

An isomorphism between two systems is by definition a triple of isomorphisms between curves commuting with the four given morphisms.

We shall write down the proof for the principal congruence subgroups $\Gamma_n$. Then, the other cases follow directly, only by checking a number of compatibilities. (And we need use the theorem only for $\Gamma = \Gamma_n$.)

\subsection{}\label{art6-subsec5.2}
In this section, we shall construct the function fields with $p$-adic valuations and verify the ``generic'' congruence relation. The proof is obtained by Shimura's method \cite{art6-key17}. Owing to a result of Igusa \cite{art6-key6}, it works for \textit{all} $p$ with $p \nmid n$. The only new point to be noted here is that the action of $p^{\bZ}$ is trivialized. In any case, we shall present a full proof for the sake of completeness.

Let $j$ be a variable over $F_p$, the prime field of characteristic $p$, and $J$ be a variable over $\sF_p$. Let $K_n$, $L_n$ be the fields defined in \S \eqref{art6-subsec1.1} with respect to $F_p$ and $j$; and $\sK_n$, $\sL_n$ be the corresponding fields defined with respect to $\sF_p$ and $J$.

(A) The relation between the two characteristics is as follows. Extend the place \eqref{art6-eq5.1.3} to the place of $\sF (J)$ onto $F(j)$ by $J \rightsquigarrow j$, and call it also as $pl$.
\begin{equation}
pl : \sF (J) \to F (J) \quad (J \rightsquigarrow j). 
\label{art6-eq5.2.1}
\end{equation}
Let $pl_n$ be an extension of $pl$ to $\sL_n$. Then $pl_n$ maps $\sL_n$ onto $L_n$. This is due to Igusa \cite{art6-key5}, \cite{art6-key6}. In fact, this follows directly from the following two\pageoriginale

%%%% 191 page 


\eqref{art6-eq}





$\rightsquigarrow$


