\title{Bases for Quantum Demazure modules-I}
\markright{Bases for Quantum Demazure modules-I}

\author{By~ V. Lakshmibai\footnote{Partially supported by NSF Grant DMs 9103129 and alos by the Faculty Development Fund of Northeastern University.}}
\markboth{V. Lakshmibai}{Bases for Quantum Demazure modules-I}

\date{}
\maketitle

\begin{center}
(Dedicated to professores M. S. Narasimhan and C.S. Seshadri on their 60th birthdays)
\end{center}

\section{Introduction}\label{art9-sec-1}
Let $\fg$ be a semi-simple Lie algebra over $\bbQ$ of rank $n$. Let $U$ be the quantized enveloping algebra of $\fg$ as constructed by Drinfeld (cf \cite{art9-keyD}) and Jimbo (cf \cite{art9-keyJ}). This is an algebra over $\bbQ(v)$ ($v$ being a parameter)  which specializes to $U(\fg)$ for $v=1$, $u(g)$ being the universal enveloping algebra fo $\fg$. This algebra has agenerators $E_{i}, F_{i}, K_{i}, 1\leq i \leq n$, which satisfy \textit{the quantum Chevalley and Serre relations} (cf \cite{art9-keyL1}). Let $A= \bbZ[v, v^{-1}] $ and $U_{A}^{\pm}$ be the A-sumbalagebra of $U$ generated by $E_{i}^{r}$ (resp. $F_{i}^{r}$), $1\leq i \leq n$, $r \in \bbZ^{+}$, (here $E_{i}^{r}, F_{i}^{r}$ are the quantum divided powers (cf \cite{art9-keyJ})). Let $d=(d_{1}, ldot, d_{n}) \in (\bbZ^{+})^{n}$ and $V_{d}$ be the simple $U$-module with a non-zero vector e such that $E_{i}e=0$, $K_{i}e =v^{-d_{i}}e$ (recall that $V_{d}$ is unique up to isomorphism). Let us denote $V_{d}$ by just $V$. Let $W$ be the Weyl group of $\fg$.

Let $w \in W$ and let $w=s_{i_{1}}\ldots s_{i_{r}}$ be a reduced expression for $w$. Let $U_{w,A}^{-}$ denote the $A$-submodule of $U$ spanned by $F_{i_{1}}^{(a_{1})}\ldots F_{i_{r}}^{ar}, a_{i}\in \bbZ^{+}$. We observe (\cite{art9-keyL4}) that $U_{w,4}^{-}$ depends only on $w$ and not onth reduced expression chosen. For $w\in W$, let $V_{w,A}=U_{w,A}^{-}e$. We shall refer to $V_{w, A}$ as the \textit{Quantum Demazure module associated with $w$.} Let $w_{0}$ be the unique element in $W$ of maximal lenght. Then $V_{w_{0},A}$ is simply $U_{A}^{-}e$. In the sequel, we shall denote $V_{w_{0}, A}$ by just $V_{A}$.

Let $g=s\ell$ {(\bf 3)}. In this paper, we construct an A-basis for $V_{A}$, which is compatible with $\{V_{w,A}, w \in W\}$. The construction is done using the configuration of Schubert varieties in the Flag variety $G/B$. Let $Id=\mu_{0} < \mu_{1} < \mu_{2} < \mu_{3} = w_{0}$ be a chain  in $W(=S_{3})$. Let $\mu_{i-1} = s_{\beta_{i}}\mu_{i}$ for some positive root $\beta_{i}$. Let $n(\mu_{i-1},\mu_{i})= (\mu_{i-1}(\lambda), \beta_{i}^{*})$, where $\lambda = d_{1}\omega_{1} + d_{2}\omega_{2}, \omega_{1}$ and $\omega_{2}$ being the fundamental weights of $s\ell(3)$. Let denote $n(\mu_{i-1}, \mu_{i})$ by just $n_{i}$. Let $C = \{ (\mu_{0}, \mu_{1}, \mu_{2}, \mu_{3};m_{1}, m_{2}, m_{3}) : 1 \geq \frac{m_{1}}{n_{1}}\geq \frac{m_{2}}{n_{2}} \geq \frac{m_{3}}{n_{3}} \geq 0 \}$. Given $c=(\mu_{0}, \mu_{1}, \mu_{2}, \mu_{3};m_{1}, m_{2}, m_{3})$, Let $\tau_{c} = \mu_{r}$, where $r$ is the largest integer such that $m_{r}\neq 0$. Given two elements
$$
c_{1} = \{(\mu_{0}, \mu_{1}, \mu_{2}, \mu_{3};m_{1}, m_{2}, m_{3})\}, c_{2}=\{ \lambda_{0}, \lambda_{1}, \lambda_{2}, \lambda_{3} ; p_{1}, p_{2},p_{3}\}
$$
in $C$. let us denote $\frac{m_{i}}{n(\mu_{i-1},\mu_{i})}$ (resp. $\frac{p_{i}}{n(\lambda_{i-1}, \lambda_{i})}$) by just $a_{i}$ (resp. $b_{i}$). We say $c_{1}\sim c_{2}$, if
\begin{enumerate}[(1)]
\item $a_{i}= b_{i}$
\item either
   \begin{enumerate}[(a)]
    \item $a_{1} =a_{2} > a_{3}, \mu_{2} = \lambda_{2}$

    or 

    \item $a_{1} > a_{2} =a_{3}, \mu_{1} =\lambda_{1}$

    or

    \item $a_{1} = a_{2} = a_{3} $
    \end{enumerate}
\end{enumerate}
We shall denote $C/\sim $ by $\overline{C}$, For $\theta \in \overline{C}$, we shall denote $\tau_{\theta} = \tau{\theta}, c$ being a representative for $\theta$ (note that $\tau_{\theta}$ is well-defined). We have (Theorems \ref{art9-thm-6.7} and \ref{art9-thm-7.2})

\begin{theorem}
$V_{A}$ has an $A$-basis $B_{d}=\{v_{\theta}, \theta \in \overline{C}\}$ where $v_{\theta} = D_{\theta}e, D_{\theta}$
being a monomial in $F_{i}^{'}s$ of the form $F_{i_{1}}^{(n_{1})}\ldots f_{i_{r}}^{(nr)}$. Further, for
$w \in W, \{v_{\theta} | w \geq \tau_{\theta}\}$ is an $A$-basis for $V_{w, A}$.
 \end{theorem}

Let $\calB_{d}$ denote Lusztig's canonical basis for $V_{A}$ (cf \cite{art9-keyL2}). It turns out that the transition matrix from $B_{d}$ to $\calB_{d}$ is upper triangular. We also give a conjectural $A$-basis $B_{d}$ for $V_{A}$ for $\fg$ of other types. An element in $B_{d}$ is again of the form $F_{i_{1}}^{(n_{1})}\cdots F_{i_{r}}^{(nr)}e$. We conjecture that the trasition matrix from $B_{d}$ to $\calB_{d}$ is upper triangular. The sections are organized as follows. In \S2,
we recall some results pertaining to the configuration of Schubert varieties in $G/B$. In \S3, we describe a conjectural $A$-basis  for $V_{A}$ (and also for $V_{w, A}$). In \S4, we study $\overline{C}$ in detail and constuct $B_{d}$ and $\calB_{d}$. In \S6 and \S7, we prove the results for $G=SL(3)$. in \S8, an Appendix, we have explicitly established a bijection between the elements of $\overline{C}$ (the indexing set for $B_{d}$) and the classical standard Young tableaux on $SL(3)$ of type $(d_{1}, d_{2})$.

The author would like to express her gratitude to SPIC Science Foundation for the hospitality extended to het during her stay (Jan-Feb, 1992) there, when research pertatining to this paper was carried out.

\section{Preliminaries}\label{art9-sec-2}

Let $G$ be a semi-simple, simply connected Chevalley group defined over a field $k$. Let $T$ be a maximal $k$-split torus, $B$ a Borel subgroup$, B\supset T$. Let $W$ be the Weyl group, and $R$ the root system of $G$ relative to $T$ . Let $R^{+}$ (resp. $S$) be the system of positive (resp. simple) roots of $G$ relative to $B$. For $w \in W$, let $X(w) = \overline{BwB}(\mod B)$ be tghe Schubert variety in $G/B$ associated with $w$.

\begin{definition}\label{art9-definition-2.1}
Let $X(\varphi)$ be a Schubert divisor in $X(\tau)$. We say that $X(\varphi)$ is \textit{moving divisor in} $X(\tau)$ \textit{moved by the simple root} $\alpha$, if $\varphi=s_{\alpha} \tau$.
\end{definition}

\begin{lemma}\label{art9-lemma-2.2}
{\bf Cf \cite{art9-keyL-S}}. Let $X(\varphi)$ be a moving divisor in $X(\tau)$ moved by $\alpha$. Let $X(w)$ be a Schubert subvariety in $X(\tau)$. Then either
\begin{enumerate}[(i)]
\item $X(w) \subseteq X(\varphi)$ or\label{art9-lemma2.2-enum-1}
\item $X(w) = X(s_{\alpha}w')$ for some $X(w') \subseteq X(\varphi)$.\label{art9-lemma2.2-enum-2}
\end{enumerate}
\end{lemma}

\begin{definition}\label{art9-definition-2.3}
Let $\lambda$ be a dominant integral weight of $G$. Let $X(w)$ be a divisor on $X(\tau)$. Let $w=s_{\beta}\tau$, for some $\beta \in R^{+}$. We define $m_{\lambda}(w, \tau)$ as the  non-negative integer $m_{\lambda}(w, \tau) = (w(\lambda), \beta^{*})(= -(\tau(\lambda), \beta^{*}))$, and call it the lambda \textit{multiplicity} of $X(w)$ in $X(\tau)$. (Here (,) is a$W$-invariant scalar product on $Hom(T, G_{m})$). 
\end{definition}

\begin{lemma}\label{art9-lemma-2.4}
Let $X(\varphi)$ be a moving divisor in $X(\tau)$ moved by $\alpha$. Let $X(w)$ be divisor in $X(\tau)$. Let $w=s_{\beta}\tau$, $\theta = s_{\alpha}\varphi$, where $\beta, \gamma \in R^{+}$ (note that $\gamma = s_{\alpha}(\beta))$. Let $m=m_{\lambda}(w, \tau), s=m_{\lambda}(\theta, w), p=m_{\lambda}(\varphi, tau), r = (\beta, \alpha^{*})$.
Then
\begin{enumerate}[(a)]
\item $m_{\lambda}(\theta, \varphi) =m$ \label{art9-lemma2.4-enum-1}
\item $p=s+mr$\label{art9-lemma2.4-enum-2}
\end{enumerate}
\end{lemma} 

\begin{proof}
~

\begin{enumerate}[(a)]
\item $m_{\lambda}(\theta, \varphi) = (\theta(\lambda), \gamma^{*}) = (\theta(\lambda), (s_{\alpha}\theta(\lambda)), \beta^{*}) =(w(\lambda), \beta^{*}) = m$

\item Now $s_{\beta}s_{\alpha}\theta(\lambda) = s_{\alpha}s_{\gamma}\theta(\lambda)$ implies that $s\alpha + m\beta =m\gamma+ p\alpha$. Hence $(p-s)\alpha=m\beta-m\gamma =m(\beta-r\alpha)=mr\alpha$. Hence $p=s+mr$.
\end{enumerate}
\end{proof}

\begin{lemma}\label{art9-lemma-2.5}
Let $X(\theta)$ be a divisor in $X(\tau)$. Let $\theta = s_{\beta}\tau$, where $\beta \in R^{+}$. Let $\beta$ be non-simple, say $\beta = \Sigma c_{i}\alpha_{i}, \alpha_{i} \in S$. Then for at least one $i$ with $c_{i}\neq 0$, we have
$(\tau (\lambda), \alpha_{i}^{*})< 0$.
\end{lemma}

\begin{proof}
Let $m=m_{\lambda}(\theta,\tau)$. Then $(\tau(\lambda), \beta^{*})= -m < 0$. The assertion follows from this.
\end{proof}

\setcounter{subsection}{5}
\subsection{Lexicographic shellability}\label{art9-subsec-2.6}
~

Given a finite partially ordered set$H$ which is graded (i.e., which has an unique maximal and an unique minimal element and in which all maximal chains m i.e., maximal totally ordered subsets of $H$, have the same length), the
\textit{lexicographic shellability} of $H$ (cf \cite{art9-keyB-W}) consists in labelling the maximal chains $\underline{m}$ in $H$, say $\lambda(\underline{m})= (\lambda_{1}(\underline{m}), \lambda_{2}(\underline{m}), \ldots, \lambda_{r}(\underline{m}))$ (here r in the length of any maximal chain in $H$), where $\lambda_{i}(\underline{m})$ belong to some partially ordered set $\Omega$, in such a way that the following two conditions hold:

\noindent
{(\bf L1)} If two maximal chains $\underline{m}$ and $\underline{m}'$ coincide along their first $d$ edges, for some $d$, $1 \geq d \geq r$, then $\lambda_{i}(\underline{m})= \lambda_{i}(\underline{m}'), 1 \leq i \leq d$.

\noindent
{(\bf L2)} For any interval $[x,y](= \tau \in H : X\geq \tau \geq y)$, together with a chain $\underline{c}$ going down from the unique maximal element in $H$ to $y$, there is a unique maximal chain $m_{0}$ in $[x,y]$ whose label is increasing (i.e. $\lambda_{1}(m_{0})\leq \lambda_{2}(m_{0})\leq \cdots \lambda_{t}(m_{0})$, $t$ being the lenght of any maximal chain in $[x,y]$) and if $\underline{m}$ is any other maximal chain in $[x,y]$, then $\lambda(\underline{m}_{0})$ is lexicographically $, \lambda(m)$ (here, the label for any chain $\underline{m}$ in $[x,y]$ is induced from the maximal chain of $H$ consisting of $\underline{c}$, followed by $\underline{m}_{0}$, followed by an arbitrary path from $x$ to the unique minimal element of $H$.) 

\setcounter{equation}{6}
\begin{theorem}\label{art9-thm-2.7}
 {\rm(cf \cite{art9-keyB-W})} the Bruhat order of a Coxeter group is lexicographic shellable.
\end{theorem}

\setcounter{subsection}{7}
\subsection{Labelling of maximal chains in $[x,y]$ for $H=W$}\label{art9-subsec-2.8}
~

\noindent
 We fix a reduced expression of $w_{0}$,the element of the maximal length in $W$ and label the maximal chains in $X$ as in \cite{art9-keyB-W}(with respect to this fixed reduced expression for $w_{0}$). Let $\underline{m}$ be maximal chain in $[x,y]$. Let $\underline{c}$ be the (unique) chain from  $w_{0}$ to $y$ whose label is increasing. We take the label for $\underline{m}$ as the induced by maximal chain in $W$ consisting of $\underline{c}$, followed by $\underline{m}$, followed by an arbitrary path from $x$ to $Id$.  

\section{A conjectural Bruhat-order compatible A-basis for $V_{A}$}\label{art9-sec-3}

\subsection{}\label{art9-subsec-3.1}
Let $\fg =Lie(G)$. Let $U, A, U_{A}^{\pm}, E_{i}, F_{i}, K_{i}, V_{d}, V_{A}, V_{w,A}$ etc. be as in \S1. Let $\lambda = \Sigma d_{i}\omega_{i}, \omega_{i}$ being the fundamental weights of $G$. We shall index that set of simple roots of $G$ as in \cite{art9-keyB}. Let $\underline{c} = \{\mu_{0},\mu_{1}, \ldots, \mu_{r}\}$ be a chain in $W$, i.e., $\ell(\mu_{i})= \ell(\mu_{i-1}) +1$ (if $d_{t} =0$ for $t=i_{i}, \ldots, i_{s}$, then we shall work with $W^{Q}$, the set of minimal representatives of $W_{Q}$ in $W, W_{Q}$ being the subgroup of $W$ generated by the set of simple reflections $\{s_{t}, t=i_{1} \ldots, i_{s}\}$). Let $\mu_{i-1} = s_{\beta_{i}\mu_{i}}, \beta_{i} \in R^{+}$. Let $m_{\lambda}(\mu_{i-1}, \mu_{i}) =m_{i}$. We set $\ell(\underline{c}) = r$, and call it the \textit{length} of $\underline{c}$. 

\setcounter{equation}{1}
\begin{definition}\label{art9-definition-3.2}
A chain $\underline{c}$ is called \textit{simple} (resp. \textit{non-simple} if all (resp. some) $\beta_{i}'s$ are simple (resp. non-simple)).
\end{definition}

\begin{definition}\label{art9-definition-3.3}
By a \textit{weighted} chain, we shall mean ($\underline{c}, \underline{n}$) where $\underline{c}= \{ \mu_{0}, \ldots, \mu_{r}\}$ is a chain and $\underline{n} = \{ n_{1}, \ldots, n_{r}\}, n_{i} \in \bbZ^{+}$.
\end{definition}

\begin{definition}\label{art9-definition-3.4}
A weighted chain ($\underline{c}, \underline{c}, \underline{n} $) is said to be \textit{admissible} if $1 \geq \frac{n_{1}}{m_{1}}\geq \frac{n_{2}}{m_{2}}\geq \cdots \geq \frac{n_{r}}{m_{r}}\geq 0$.
\end{definition}

\begin{lemma}\label{art9-lemma-3.5}
Let $X(\varphi)$ be a moving divisor in $X(\tau)$ moved by the simple root $\alpha$. Let $\underline{c} = \{\mu_{0}, \mu_{1}, \ldots \mu_{r} = \tau\}$ be a chain, and let $\mu_{i-1} = s_{\beta}\mu_{i}, \beta_{i} \in R^{+}$. Further let
$\beta_{r} \neq \alpha$, and $\beta_{i} \in S, i\neq r$ (note that we allow $\beta_{r}$ to be non-simple). Then either
\begin{enumerate}[(1)]
\item $\beta_{i}=\alpha$, for some $i$, {\rm(or)}\label{art9-lemma3.5-enum-1}
\item $\beta_{i} \neq \alpha, 1 \leq i \leq r$, in which case $\mu_{i} > s_{\alpha}\mu_{i}$, and $s_{\alpha}\mu_{i} < \varphi, 0 \leq i \leq r$\label{art9-lemma3.5-enum-1}
\end{enumerate}
\end{lemma}

\begin{proof}
Let $\beta_{i} \neq \alpha$, $ 1 \leq i \leq r$. We shall now show that $ \mu_{i} > s_{\alpha}\mu_{i}, 0 \leq i \leq r$.
For $i=r$, this is clear (since $s_{\alpha}\mu_{r}= \varphi < \tau$). For $i=r-1$,this follows from Lemma
\ref{art9-lemma-2.2} We have
$$
(\mu_{r-2}(\lambda), \alpha^{*})= (\mu_{r-1}(\lambda)+ m_{r-1} \beta_{r-1}, \alpha^{*})< 0,
$$
since $(\mu_{r-1}(\lambda), \alpha^{*})< 0$, and $(\beta_{r-1}, \alpha^{*})\leq 0$. (note that $\mu_{r-1} > s_{\alpha}\mu_{r-1} \Rightarrow (\mu_{r-1}(\lambda), \alpha^{*})< 0$ ,and that $(\beta_{r-1}, \alpha^{*})\leq 0$, since $\beta_{i} \in S, 1\leq i \leq r-1$). Hence $\mu_{r-2} > s_{\alpha}\mu_{r-2}$. In a similar way one concludes $\mu_{i} > s_{\alpha}\mu_{i}$. The assertion that $s_{\alpha}\mu_{i}$ is $< \varphi$ follows Lemma \ref{art9-lemma-2.2}.
\end{proof}

\setcounter{subsection}{5}
\subsection{}\label{art9-subsec-3.6}

Let $(\underline{c}, \underline{n})$ be an admissible weighted chain. With notations and assumptions as in
Lemma \ref{art9-lemma-3.5}, we define as admissible weighted chain $(s_{\alpha}(\underline{c}), s_{\alpha}(\underline{n}))$ as follows:

\begin{case}\label{art9-case-1}
Let $\beta_{i}\neq \alpha, 1 \leq i \leq r$. We set
\begin{align*}
s_{\alpha}(\underline{c}) &= \{s_{\alpha}\mu_{0}, s_{\alpha}\mu_{1}, \ldots, s_{\alpha}\mu_{r} = {\varphi}\}\\
s_{\alpha}(\underline{n}) &= \underline{n}
\end{align*}
(Note that $m_{\lambda}(s_{\alpha}\mu_{i-1}), s_{\alpha}\mu_{i}) = m_{\lambda}(\mu_{i-1}, \mu_{i})$
(Lemma \ref{art9-lemma-2.4} (\ref{art9-lemma2.4-enum-1})) and hence ($s_{\alpha}(c), s_{\alpha}(n))$ is admissible). 
\end{case}

\begin{case}\label{art9-case-2}
Let $\beta_{i}= \alpha$, from some $i, 1\leq i \leq r$. Let $t$ be the largest integer, $1 \leq t \leq r$ such that $\beta_{t} = \alpha$. We set
$$
s_{\alpha}(\underline{c}) = \{ \mu_{0}, \mu, \cdots, \mu_{r-1} = s_{\alpha}\mu_{t}, s_{\alpha}\mu_{t}, s_{\alpha}\mu_{t+1}, \cdots, s_{\alpha}\mu_{r} = \varphi\}
$$
and we define $s_{\alpha}(\underline{n}) = \{n_{i}', \cdots, n_{r-1}'\}$ by
\begin{align*}
n_{i}' &= n_{i}, 1\leq i \leq t-1\\
n_{i}' &= n_{i+1}, t\leq i\leq r-1
\end{align*}
(note that $1 \geq \frac{n_{1}'}{m_{1}'} \geq \cdots \geq \frac{n_{r-1}'}{m_{r-1}'} \geq 0$, by the same considerations as in Case \ref{art9-case-1} (here $m_{i}' =m_{i}, 1 \leq i \leq t-1, m_{i}'(=(s_{\alpha}\mu_{i}, s_{\alpha}\mu_{i+1}))=m_{i+1}, t \leq i \leq r-1)$.
\end{case}

\subsection{}\label{art9-subsec-3.7}
With notations and assumptions as in \ref{art9-subsec-3.6}, we donet by $(\underline{c}_{\alpha}, \underline{n}_{\alpha})$ the admissible weighted chain, where
$$
\underline{c}_{\alpha} = (s_{\alpha}(\underline{c}), \mu_{r}), n_{\alpha} = (s_{\alpha}(\underline{n}), n_{r}')
$$
and $n_{r}'$ in given as follows:

Let
\begin{align*}
k &=
\begin{cases}
0,\; \text{if case}\; 1 \; \text{holds}\\
t, \; \text{if case}\; 2 \;\text{holds}
 \end{cases}
\end{align*}
For $i\geq k$, let $\gamma_{i}=s_{\alpha}(\beta_{i})$ (note that $s_{\alpha}\mu_{i-1}= s_{\gamma_{i}}s_{\alpha}\mu_{i}$).
\begin{align*}
x&=
\begin{cases}
m(s_{\alpha}\mu_{0}, \mu_{0}), \; \text{if case} \; 1\; \text{holds}\\
n_{t}, \quad \text{if case}\; 2 \; \text{holds}
\end{cases}\\
y&=
\begin{cases}
\sum n_{i}(\beta_{i}, \alpha^{*})\\
\{i > k \;|\; \gamma_{i} \neq \beta_{i}\}
\end{cases}
\end{align*}
$$
n_{r}'= x+y
$$
Then $n_{r}'$ is given by
$$
n_{r}' = x+y
$$

\subsection{}\label{art9-subsec-3.8}

Let $(\underline{c}, \underline{n})$ be an admissible weighted chain. Further, let $\underline{c}$ be not simple. To $(\underline{c}, \underline{n})$, we attach a canonical (not necessarily admissible) weighted chain $(\delta(\underline{c}), \delta(\underline{n}))$ with $\delta(\underline{c})$ simple, as follows: We preserve the above notation for $\underline{c}$. We do the construction using induction on $r(=\ell(\underline{c}))$. 

\subsection*{Starting point of induction}
Let $\underline{c}=\{(\tau, w)\}$,where $x(w)$ is a divisor in $X(\tau),w = s_{\beta}\tau, \beta \in R^{+}, \beta$ non-simple. (We refer to this situation as $X(w)$ \textit{being a non-moving divisor} in $X(\tau)$). Let $n=(n_{1})$, where $n_{1} \leq m(=m_{\lambda}(w,\tau))$. By induction on $\dim X(\tau)$, we may suppose that $X(\tau)$ is of least dimension such that $X(\tau)$ has a non-moving divisor. Let $\beta =\Sigma c_{i}\alpha_{i}$. then at least for one $i$ with $c_{i}\neq 0$, we have $(\tau(\lambda), \alpha_{i}^{*}) < 0$ (Lemma \ref{art9-lemma-2.5}). Let t be at least for one $i$  with $c_{t}\neq 0$ such that $(\tau(\lambda), \alpha_{t}^{*})< 0$ (the indexing of the simple roots being as
in \cite{art9-keyB}). Denote $\alpha_{t}$ by just $\alpha_{t}$ by just $\alpha$. Let $s_{alpha}w = \theta, \varphi =s_{\gamma}\theta$. Then $\gamma = s_{\alpha}(\beta)$. Further by our assumption on $\dim X(\tau), \gamma \in S$. Hence we obtain $(\beta, \alpha^{*}) > 0$, say $(\beta, \alpha^{*})=r$, and $\beta = \gamma + r \alpha$. We set
$$
(\delta(\underline{c}), \delta(\underline{n}))=\{(\theta, \varphi, \tau); (p_{1},p_{2})\}
$$
where $p_{1}=n_{1}$, $P_{2}=n_{1}+a$ with $a=m_{\lambda}(\theta, w)$ (lemma \ref{art9-lemma-2.4}).

Let now $\ell(\underline{c}) > 1$. Let $\underline{c}= \{\mu_{0}, \mu_{1}, \ldots, \mu_{r}\}, \mu_{i-1} = s_{\beta}\mu_{i}, 1\leq i \leq r$. We may suppose that $\beta_{i} \in S, 1 \leq i < r$. For, otherwise, if $i$ is the least integer such that $\beta_{i}$ in non-simple we may work with $(\Delta(\underline{n}), \Delta(\underline{c}))$, (where   $\Delta(\underline{c})$ is the chain $\delta(\mu_{0},\cdots,\mu_{i})$ followed by $\{ \mu_{i+1}, \cdots, \mu_{r}\}$, and use induction on $\#\{t, 1\leq t \leq r : \beta_{t} \text{is non-simple}\}$. Let us denote $\beta_{r}$ by just $\beta$. Let $\beta =\Sigma c_{i}\alpha_{i}$. Since $(\tau(\lambda), \beta^{*}) < 0$, we have
(Lemma \ref{art9-lemma-2.5}, for at least one $t$ with $c_{t}\neq 0, (\tau(\lambda), \alpha_{t}^{*})< 0$. Let $i$ be the least integer such that $c_{i}\neq 0$ and $(\tau(\lambda), \alpha_{i}^{*}) < 0$. Let us denote $\alpha_{i}$ by just $\alpha$. Let  $\varphi= s_{\alpha}\tau$. We set \eqref{art9-subsec-3.7}
$$
\delta(\underline{c})= \underline{c}_{\alpha}, \delta(\underline{n}) = \underline{n}_{\alpha}
$$


\subsection{}\label{art9-subsec-3.9}
Given a simple weighted chain $(\underline{c}, \underline{n})$ (not necessarily admissible) we set
$$
v_{\underline{c},\underline{n}} = F_{i_{r}}^{(n_{r})}\cdots F_{i_{1}}^{(n_{1})}e_{\mu}
$$
where $\underline{c} = \{\mu = \mu_{0},\ldots \mu_{r}\}$, $\underline{n} = \{n_{1}, \ldots, n_{r}\}$, $\beta_{t} = \alpha_{i_{t}}, 1 \leq t \leq r$, and $e_{\mu}$ is the extermal weight vector associated to $\mu$, (Note that it $\tau_{0} = Id < \tau_{1} < \cdots < \tau_{r} = \mu$ is anu simple chain from $Id$ to $\mu$, and $\tau_{i-1}= s_{\beta}\tau_{i}, \beta_{i} \in S, 1 \leq i \leq r$, then $e_{\mu} =F_{\beta_{r}}^{(n_{r})}\ldots F_{\beta_{1}}^{(n_{1})}e$, where $n_{i}=m_{\lambda}(\tau_{i-1}, \tau_{i})$ \eqref{art9-definition-2.3})

\subsection{}\label{art9-subsec-3.10}
Let $(\underline{c}, \underline{n})$ be admissible. Let us denote the unequal values in $\{ \frac{n_{1}}{m_{1}}, \cdots, \frac{n_{r}}{m_{r}}\}$ by $a_{1}, \cdots, a_{s}$ so that $1\geq a_{1} > a_{2}> \cdots > a_{s} \geq 0$. Let $i_{0}, \cdots, i_{s}$ be defined by
$$
i_{0}=0, i_{s}=r, \dfrac{n_{j}}{m_{j}} =a_{t}, i_{t-1}+1 \leq j \leq i_{t}
$$
We set
$$
D_{\underline{c}, \underline{n}} = \{(a_{1}, \cdots, a_{s}); (\mu_{i_{0}}, \cdots, \mu_{i_{s}})\}
$$

\setcounter{equation}{10}
\begin{definition}\label{art9-definition-3.11}
Let $(\underline{c}, \underline{n})$, $(\underline{c}', \underline{n}')$ be two admissible weighted chains. Let $D_{\underline{c}, \underline{n}_{\sim}}(\underline{c}', \underline{n}')$, if $s=t$, and $a_{t}= a_{t}'$,$i_{t}=j_{t}$, $\mu_{i_{t}} = \tau_{j_{t}}$, $0 \leq t \leq s$
\end{definition}

\setcounter{subsection}{11}
\subsection{}\label{art9-subsec-3.12}
Given $\mu, \tau \in W, \mu < \tau$, we shall label the chain in $[\mu \tau]$ as in \ref{art9-subsec-2.8}.
Let $C=\{$all admissible weighted chains$\}$, and $\overline{C}=C/_{\sim}$. Given $x \in \overline{C}$, let

$$
S_{x}=\{(\underline{c}, \underline{n}) \in C: (\underline{c}, \underline{n})\; \text{is a representative of}\; x \; and \; \underline{c}\; \text{is simple}\}
$$
$$
N_{x}=\{(\underline{c}, \underline{n}) \in C : (\underline{c},\underline{n})\; \text{is a representative of}\; x \; and \;\underline{c} \; \text{in non-simple}\}
$$

Let us define $x_{\min} \in C$ as follows.

\setcounter{case}{0}
\begin{case}\label{art9-subsec3.12-case-1}
$S_{x} \neq \phi$. We set
$$
x_{\min}= (\underline{c}_{0}, \underline{n}_{0})
$$
where $(\underline{c}_{0}, \underline{n}_{0})$ is lexicographically the least in $S_{x}$.
\end{case}

\begin{case}\label{art9-subsec3.12-case-2}
$S_{x}\neq \phi$. In this case we set
$$
x_{\min} = (\underline{c}_{0}, \underline{n}_{0})
$$
where $(\underline{c}_{0}, \underline{n}_{0})$ is lexicographically the least in $N_{x}$.
\end{case}

\subsection{}\label{art9-subsec-3.13}
Let $x \in \overline{C}$. Let $x_{\min}= (\underline{c}_{0}, \underline{n}_{0})$. Define $v_{x} \in V_{A}$ as follows:

\setcounter{case}{0}
\begin{case}\label{art9-subsec3.13-case-1}
$S_{x}\neq \phi$. We set
$$
v_{x}=v_{\underline{c}_{0}, \underline{n}_{0}}
$$
\end{case}
\begin{case}\label{art9-subsec3.13-case-2}
$S_{x}=\phi$. We set
$$
v_{x}=v_{\delta(\underline{c}_{0}), \delta(\underline{n}_{0})}
$$
\end{case}

\subsection{}\label{art9-subsec-3.14}
 Let $x\in \overline{C}$. Let $(\underline{c}, \underline{n})$ be a representative of $x$. Let $\underline{c} = (\mu_{0}, \cdots, \mu_{r})$. We define $\tau_{x} = \mu_{s}$, where is $s$ is the largest integer such that $n_{x} \neq 0$ (Note that $\tau_{x}$ is well-defined).

\setcounter{equation}{14}
\begin{conjectures}\label{art9-conjectures-3.15}
~

\begin{enumerate}[(1)]
 \item $\{ v_{x}, x \in \overline{C}\}$ is an $A$-basis for $V_{A}$

 \item $\{v_{x}: w \geq \tau_{x}\}$ is an $A$-basis for ${A, w}$

 \item Let $B_{d}$ denote $\{v_{x}, x \in \overline{C}\}$, and $\calB_{d}$, Lusztig's canonical basis for $V_{A}$ (\cite{art9-keyL2}). The transition matrix from $B_{d}$ to $\calB_{d}$ is upper triangular.
\end{enumerate}
\end{conjectures}

\section{The case G = SL $(3)$}\label{art9-sec-4}

\subsection{}\label{art9-subsec-4.1}
For the rest of the paper we shall suppose that $G=SL(3)$. Let us denote that elements of $W$ by $\{\tau_{i}, \phi_{i}, i=0,1,2,3, j=1,2\}$, where $\tau_{0} = Id, \tau_{1} =s_{1}, \tau_{2} =s_{2}s_{1}, \tau_{3} =s_{1}s_{2}s_{1}, \varphi_{2} =s_{1}s_{2}$.  We shall label the maximal chains in $W$ with respect to teh reduced expression $s_{1}s_{2}s_{1}$ of $w_{0}$ (\cite{art9-keyB-W}). 

\subsection{}\label{art9-subsec-4.2}
Let $d=(d_{1}, d_{2})$ and $\lambda = d_{1}\omega_{1} + d_{1}\omega_{2}$. We shall suppose that $d_{1}, d_{2}$ are both non-zero (If $d_{1}=0$ for instance,then we work with $\{Id, s_{2}, s_{1}s_{2}\}$, the set of minimal representatives of $W_{p}(=\{s_{1}, Id\})$ in $W$). Also, for simplicity of notation, we shall denote $d_{1}$ by $m$ and $d_{2}$ by $n$.

\subsection{}\label{art9-subsec-4.3}

Given a pair $(\varphi,,\tau)$ such that $X(\varphi)$ is a divisor in $X(\tau)$, let us denote $m_{\lambda}(\varphi, \tau)$ bu just $m(\varphi, \tau)$. We have
\begin{align*}
m(\varphi, \tau) &=
\begin{cases}
m, \quad \text{if}\; (\varphi, \tau) =(\tau_{0}, \tau_{1}), (\varphi_{1}, \tau_{2}) \;\text{or}\; (\varphi_{2}, t_{3})\\
m+n,\quad \text{if}\; (\varphi, \tau) =(\tau_{1}, \tau_{2})\; \text{or} \; (\varphi_{1}, \varphi_{2})\\
n, \quad \text{if} \; (\varphi, \tau) =(\tau_{0}, \varphi_{1}), (\tau_{1}, \varphi_{2})\; \text{or}\; (\tau_{2}, \tau_{3})
\end{cases}
\end{align*}

\subsection{}\label{art9-subsec-4.4}
We shall denote an admissible weighted chain $\underline{c} =(\mu_{0},\mu_{1}, \mu_{2}, \mu_{3}), \underline{n} = (n_{1}, n_{2}, n_{3})$, where if $n_{i} = 0$, $i$ being the least such integer, then $\underline{c}$ is to be understood as the chain $(\nu_{0}, \cdots,\mu_{i-1})$. For instance, if $n_{3}=0$ and $n_{1}, n_{2}$ are non-zero then $\underline{c} = (\mu_{0}, \mu_{1},\mu_{2})$. If $n_{1}=0 =n_{2} =n_{3}$, we shall call $\underline{c}$ a \textit{trivial chain} consisting of just $\mu_{0}$.  

\subsection{}\label{art9-subsec-4.5}
We have four types of admissible weighted chains given as follows.
\begin{enumerate}[Type I:]
\item $\{(\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}), (n_{1}, n_{2}, n_{3}) : 1 \geq \frac{n_{1}}{m} \leq \frac{n_{2}}{m+n}   \geq \frac{n_{3}}{n}\geq 0\}$\label{art9-subsec4.5-I}

\item $\{(\tau_{0}, \varphi_{1}, \tau_{1}, \tau_{3}), (n_{1}, n_{2}, n_{3}) : 1 \geq \frac{n_{1}}{n} \leq \frac{n_{2}}{m} \geq \frac{n_{3}}{n} \geq 0\}$\label{art9-subsec4.5-II}

\item $\{(\tau_{0}, \tau_{1}, \varphi_{2}, \tau_{3}), (n_{1}, n_{2}, n_{3}) : 1 \geq \frac{n_{1}}{m} \leq \frac{n_{2}}{n} \geq \frac{n_{3}}{m} \geq 0\}$\label{art9-subsec4.5-III}

\item $\{(\tau_{0}, \varphi_{1}, \varphi_{2}, \tau_{3}), (n_{1}, n_{2}, n_{3}) : 1 \geq \frac{n_{1}}{n} \leq \frac{n_{2}}{m+n} \geq \frac{n_{3}}{m} \geq 0\}$\label{art9-subsec4.5-IV}
\end{enumerate}

\subsection{}\label{art9-subsec-4.6}
Given
$$
\Delta_{1} = ((\mu_{0},\mu_{1}, \mu_{2}, \mu_{3}),(n_{1},n_{2}, n_{3})), \Delta_{2} = ((\lambda_{0}, \lambda_{1}, \lambda_{2}, \lambda_{3})(p_{1}, p_{2}, p_{3}))
$$
in $C$, let use denote $\frac{n_{i}}{m(\mu_{i-1}, \mu_{i})}$ (resp. $\frac{p_{i}}{m(\lambda_{i-1}, \lambda_{i})}$) by just $a_{i}$(resp. $b_{i}$).  We have $\Delta_{1} \sim \Delta_{2}$, if
\begin{enumerate}[(1)]
\item $a_{i} =b_{i}$
\item

 \begin{enumerate}[(a)]
    \item $a_{1} = a_{2} > a_{3}, \mu_{2} =\lambda_{2}$, or\label{art9-subsec4.6-enum-(a)}
    \item $a_{1} > a_{2} = a_{3}, \mu_{1} =\lambda_{1}$, or\label{art9-subsec4.6-enum-(b)}
    \item $a_{1} = a_{2} = a_{3}$\label{art9-subsec4.6-enum-(c)}
 \end{enumerate}
\end{enumerate}
We note that if (a) holds, then $\lambda_{2}=\tau_{2}$ or $\varphi_{2}$, and the equivalence can hold only between elements of either Type \ref{art9-subsec4.5-I} and \ref{art9-subsec4.5-II}, or Type \ref{art9-subsec4.5-III} and
\ref{art9-subsec4.5-IV} repectively if (b) holds, then $\lambda_{1}= \tau_{1}$ or $\varphi_{1}$, and the equivalence can  hold only between elements of either Type  \ref{art9-subsec4.5-I} and \ref{art9-subsec4.5-III} or
Type \ref{art9-subsec4.5-II} and \ref{art9-subsec4.5-IV} respectively.

\subsection{}\label{art9-subsec-4.7}
Let $x \in \overline{C}$. Let $ x_{\min} = (\underline{c}, \underline{n})$ \eqref{art9-subsec-3.12}. Let $\underline{c} = (\mu_{0}, \mu_{1}, \mu_{2},,\mu_{3})$, $\underline{n} = (n_{1}, n_{2}, n_{3})$, and $a_{i}$, $1 \leq i \leq 3$ as above. Note that if in \ref{art9-subsec-4.5}, \ref{art9-subsec4.6-enum-(a)} holds, and $\mu_{2} = \tau_{2}(resp.\varphi_{2})$, then $(\underline{c}, \underline{n})$ is of Type \ref{art9-subsec4.5-I} (resp Type \ref{art9-subsec4.5-IV}). If \ref{art9-subsec4.6-enum-(b)} holds, and $\mu_{1} = \tau_{1}(resp.\varphi_{1})$, then $(\underline{c}, \underline{n})$ is of Type \ref{art9-subsec4.5-I} (resp. type \ref{art9-subsec4.5-IV}). If \ref{art9-subsec4.6-enum-(c)} holds, then $(\underline{c}, \underline{n})$ is of Type \ref{art9-subsec4.5-I}. 

\subsection{}\label{art9-subsec-4.8}
With notation as in \ref{art9-subsec-4.7}, the element $v_{x}\in V_{A}$ \eqref{art9-subsec-3.13} may be expressed explicity as
\begin{align*}
v_{x} &=
\begin{cases}
F_{1}^{(n_{3})} F_{2}^{(n_{2})}F_{1}^{(n_{1})} e,\qquad &\text{if}\quad \underline{c}\quad \text{is of  Type I}\\
F_{1}^{(n_{3})} F_{2}^{(n_{1}+n_{2})}F_{1}^{(n_{2})} e,\qquad &\text{if}\quad \underline{c} \quad\text{is of  Type II}\\
F_{2}^{(n_{3})} F_{1}^{(n_{1}+n_{2})}F_{2}^{(n_{2})} e,\qquad &\text{if}\quad \underline{c}\quad \text{is of  Type III}\\
F_{2}^{(n_{3})} F_{1}^{(n_{2})}F_{2}^{(n_{1})} e,\qquad &\text{if}\quad \underline{c}\quad \text{is of  Type IV}
\end{cases}
\end{align*}
(note that $v_{x}$ is external $\Longleftrightarrow  n_{i}$ is either 0 or $= m_{i}$, where $m_{i}= m_{\lambda}(\mu_{i-1}, \mu_{i})$). We shall denote $\{v_{x}, x  \in \overline{C}\}$ by $B_{d}$. 

\subsection{Lusztig's canonical basis for $V_{A}$.}\label{art9-subsec-4.9}
An element in $V_{A}$ of the form $F_{1}^{(p)} F_{2}^{(q)}F_{1}^{(r)}e, q\geq p+r$ or $F_{2}^{(u)} F_{1}^{(t)}F_{2}^{(s)} e, t\geq u + s$ will be referred to as a \textit{Lusztig} element or just a \textit{L-element}. We have $F_{1}^{(r)} e \neq 0 \Longleftrightarrow r \leq m$. Let $r \leq m$; then $F_{2}^{(r)} e \neq 0 \Longleftrightarrow q \leq r + n$ (using the relation
$$
F_{2}^{(q)}F_{1}^{(r)} = \sum\limits_{j=0}^{\min(q,r)} v^{-j-(q-j)(r-j)}F_{1}^{(r-j)}F_{\alpha_{1}+ \alpha_{2}}^{(j)} F_{2}^{(q-j)})
$$
Let now, $r \leq m$, $p+r \leq q \leq r +n$; then $F_{1}^{p} F_{2}^{q}F_{1}^{r} e \neq 0$ (by $U_{q}(\bs\ell_{2}))$-theory since $K_{1}(F_{2}^{(q)}F_{1}^{(r)}e) = v^{-a}F_{2}^{(q)}F_{1}^{(r)} e$ (where $a=m+q-2r$, and $ p\leq a$). Thus an $L$-element of the form $F_{1}^{(p)}F_{2}^{(q)}F_{1}^{(r)}e$ (resp. $F_{2}^{(u)}F_{1}^{(t)}F_{2}^{(s)}e$) is non-zero if and only if $r\leq m$, and $q \leq r+n$ (resp. $s \leq n$, $t \leq s+m$). Hence if $\calB_{d}$ denotes Lusztig's canonical basis for $V_{A}$, then

\begin{equation*}
\calB_{d}= \left\{
\begin{aligned}
&F_{1}^{(p)} F_{1}^{(q)} F_{1}^{(r)} e, p+r \leq q \leq r + n, r \leq m,\quad  \text{and}\\
&F_{2}^{(u)} F_{1}^{(t)} F_{2}^{(s)} e, u+x\leq t \leq s + m, s \leq n
\end{aligned}
\right\}
 \end{equation*}
(here one notes that the if $q=p+r$, then $F_{1}^{(p)} F_{2}^{(q)} F_{1}^{(r)} e = F_{2}^{(r)} F_{1}^{(q)} F_{2}^{(p)}e$) Let $p, q, r, p', q', r' \in \bbZ^{+}$. Let
\begin{equation*}
L=\left\{
\begin{aligned}
&(p,q,r), r \leq m, p+r \leq q \leq r + n, \quad \text{and}\\
&(p',q',r'), r' \leq n, p'+r' \leq q' \leq r' + m
\end{aligned}
\right\}
\end{equation*}
where $(p,q,r)$ is identified with $(p',q', r')$, if $q= q' = r + p$, $p= r'$, $r=p'$ (note that L is an indexing set for $\calB_{d}$).

\section {A bijection between $L$ and  $\overline{C}$}\label{art9-sec-5}

\begin{lemma}\label{art9-lemma-5.1}
Let $(p,q,r)$ in $L$ be such that $ r \leq m$, $p + r \leq q \leq r + n$. Further let $\frac{r}{m}, \frac{p}{n}, \frac{q-r}{n}$ be all distinct. Then precisely one of the following holds
\begin{enumerate}[{\rm (1)}]
\item $1 \geq \frac{r}{m}\geq \frac{q}{m+n} \geq \frac{p}{n} \geq 0$\label{art9-lemma5.1-enum-1}

\item $1 \geq \frac{q-r}{n} \geq \frac{r}{m} \geq \frac{p}{n} \geq 0$ \label{art9-lemma5.1-enum-2}

\item $1 \geq \frac{q-r}{n} \geq \frac{p+r}{m+n} \geq \frac{r}{m} \geq 0$\label{art9-lemma5.1-enum-3}
\end{enumerate}
\end{lemma}

\begin{proof}
We first observe that under the hypothesis that $\frac{r}{m}, \frac{p}{n} \frac{q-r}{n}$ are distinct, the three cases are mutually exclusive. We now distinguish the following two cases. 

\setcounter{case}{0}
\begin{case}\label{art9-case-1}
$\frac{r}{m} < \frac{q}{m+n}$

\noindent
This implies that $\frac{q-r}{n} > \frac{r}{n}$. In this case $\frac{p+r}{m+n} < \frac{q-r}{n}$, necessarily; for $\frac{r+p}{m+n} \geq \frac{g-r}{n}$ would imply $\frac{p+2r-q}{m}(\geq \frac{q-r}{n}) > \frac{r}{m}$, which is not possible, since $q \geq p +r$. Hence either
\begin{enumerate}[(a)]
 \item $1 \geq \frac{q-r}{n} \geq \frac{p+r}{m+n} \geq \frac{r}{m} \geq 0$, in which case \eqref{art9-case-3}
 holds or\label{art9-case-1-enum-a}
 \item $ 1 \geq \frac{q-r}{n} \geq \frac{r}{m} \frac{p+r}{m+n} \geq 0$, in which case \eqref{art9-case-2}
 holds.\label{art9-case-1-enum-b}
\end{enumerate}
\end{case}

\begin{case}\label{art9-case-2}
$\frac{r}{m}\geq \frac{q}{m+n}$  The hypothesis that $q\geq p + r$ implies that $ \frac{q}{m+n} \geq \frac{p}{n}$.
Thus in this case \eqref{art9-case-1} holds.
\end{case}
\end{proof}

\setcounter{subsection}{1}
\subsection{}\label{art9-subsec-5.2}
Let $(p, q,r)$ in $L$ be such that $ r \leq m$, $p + r \geq q \geq r +n$. We now define an element $\theta(p,q,r)$ in $C$. Let us denote $\theta(p,q,r) = (\underline{c}, \underline{n})$, where $\underline{c}$ and $\underline{n}$ are given as follows.
\begin{enumerate}[(a)]
\item  Let $\frac{r}{m}, \frac{p}{n}, \frac{q-r}{n}$ be all distinct.\label{art9-subsec5.2-enum-a}

We set
\begin{align*}
\underline{c} &=
\begin{cases}
(\tau_{0},\tau_{1},\tau_{2},\tau_{3}), & \text{ if}\quad  \eqref{art9-lemma5.1-enum-1}\quad \text{of} \quad\eqref{art9-lemma-5.1}\quad \text{holds}\\
(\tau_{0}, \varphi_{1}, \tau_{2}, \tau_{3}), & \text{ if}\quad  \eqref{art9-lemma5.1-enum-2}\quad \text{of} \quad\eqref{art9-lemma-5.1}\quad \text{holds}\\ 
(\tau_{0}, \varphi_{1}, \tau_{2}, \tau_{3}), & \text{ if}\quad  \eqref{art9-lemma5.1-enum-3}\quad \text{of} \quad\eqref{art9-lemma-5.1}\quad \text{holds}
\end{cases}\\
n &=
\begin{cases}
(r,q, p),  &\text{if} \quad  \eqref{art9-lemma5.1-enum-1}\quad \text{of} \quad\eqref{art9-lemma-5.1}\quad \text{holds}\\
(q-r,r,p), & \text{if} \quad  \eqref{art9-lemma5.1-enum-2}\quad \text{of} \quad\eqref{art9-lemma-5.1}\quad \text{holds}\\
(q-r, p+r, r), & \text{if} \quad  \eqref{art9-lemma5.1-enum-3}\quad \text{of} \quad\eqref{art9-lemma-5.1}\quad \text{holds}
\end{cases}
\end{align*}

\item Let $\frac{r}{m} = \frac{q-r}{n} \neq \frac{p}{n}$.\label{art9-subsec5.2-enum-b}

Then \eqref{art9-lemma5.1-enum-3} of \ref{art9-lemma-5.1} cannot hold, and the cases \eqref{art9-lemma5.1-enum-1} and
\eqref{art9-lemma5.1-enum-2} of \ref{art9-lemma-5.1} coincide.

We set
$$
\underline{c}=(\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}), \underline{n}= (r, q, p)
$$

\item Let $\frac{r}{m} = \frac{p}{n} \neq \frac{q-r}{n}$.\label{art9-subsec5.2-enum-c}

Then \eqref{art9-lemma5.1-enum-1} of \ref{art9-lemma-5.1} cannot hold, and \eqref{art9-lemma5.1-enum-2}
and \eqref{art9-lemma5.1-enum-3} of \ref{art9-lemma-5.1} coincide. We set
$$
\underline{c} = (\tau_{0}, \varphi_{1}, \varphi_{2}, \tau_{3}), \underline{n} = (q-r, p+r, r)
$$

\item Let $\frac{p}{n} = \frac{q-r}{n} \neq \frac{r}{m}$.\label{art9-subsec5.2-enum-d}

This implies that $q=r +p$. In this case \eqref{art9-lemma5.1-enum-2} of \ref{art9-lemma-5.1} cannot hold,
and \eqref{art9-lemma5.1-enum-3} are mutually exclusive. We set
\begin{align*}
\underline{c} &=
\begin{cases}
(\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}), & \text{if}\quad \eqref{art9-lemma5.1-enum-1}\quad \text{of}\quad \ref{art9-lemma-5.1}\quad \text{holds}\\
(\tau_{0}, \varphi_{1}, \varphi_{2}, \tau_{3}) & \text{if}\quad \eqref{art9-lemma5.1-enum-3}\quad \text{of}\quad \ref{art9-lemma-5.1}\quad \text{holds}
\end{cases}\\
n&=
\begin{cases}
(r,q,p), & \text{if} \quad \eqref{art9-lemma5.1-enum-1}\quad \text{of}\quad \ref{art9-lemma-5.1}\quad \text{holds}\\
(q-r,p+r, r), & \text{if} \quad \eqref{art9-lemma5.1-enum-3}\quad \text{of}\quad \ref{art9-lemma-5.1}\quad \text{holds}
\end{cases}
\end{align*}

\item Let $\frac{r}{m}= \frac{p}{n} = \frac{p+r}{n+m}$.

This implies that $\frac{q}{m+n} =\frac{r}{m}= \frac{p+r}{n+m}$. Then all three cases of \ref{art9-lemma-5.1} coincide,
 and we set\label{art9-subsec5.2-enum-e}
$$
\underline{c} = (\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}), \underline{n} = (r,q, p)
$$
\end{enumerate}

\setcounter{equation}{2}
\begin{remark}\label{art9-remark-5.4}
We observe that in all of the cases \eqref{art9-subsec5.2-enum-a} through \eqref{art9-subsec5.2-enum-e} above, $(\underline{c}, \underline{n})$ is of type I, II or IV. Also, if $x = (\underline{c}, \underline{n})$, then it is easily seen that $x_{\min}= (\underline{c}, \underline{n})$.
\end{remark}


\begin{lemma}\label{art9-lemma-5.4}
Let $(p',q',r')$ in $L$ be such that $r' \leq n, p' + r' \leq q' \leq r' +m$.
Further, let $\frac{r'}{n}, \frac{q'-r'}{m} \frac{p'}{m}$ be all distinct. Then precisely one of the following holds.
\begin{enumerate}[(1)]
\item $\frac{r'}{n} \geq {q'}{m+n} \geq \frac{p'}{m} \geq 0$\label{art9-lemma5.4-enum-1}

\item $1 \geq \frac{q'-r'}{m} \geq \frac{r'}{n} \geq \frac{p'}{m} \geq 0$\label{art9-lemma5.4-enum-2}

\item $1 \geq \frac{q'-r'}{m} \geq \frac{p'+r'}{m+n} \geq \frac{r'}{n} \geq 0$\label{art9-lemma5.4-enum-3}
\end{enumerate}
\end{lemma}
The proof is similar to that of Lemma \ref{art9-lemma-5.1}.

\setcounter{subsection}{4}
\subsection{}\label{art9-subsec-5.5}
Let $(p',q',r')$ in $L$ be such that $ r' \leq n, p' +r' \leq r' +m$. We now define an element $\theta(p',q',r')$ in $C$. Let us denote $\theta(p',q',r') = (\underline{c}', \underline{n}')$, where $\underline{c}'$ and $\underline{n}'$ are given as follows.
\begin{enumerate}[(a)]
\item Let $\frac{r'}{m}, \frac{p'}{m}, \frac{q'-r'}{m}$, be all distinct. We set\label{art9-subsec5.5-enum-a}
\begin{align*}
\underline{c}'&=
\begin{cases}
(\tau_{0}, \varphi_{1}, \varphi_{2}, \tau_{3}),& \text{if}\quad \eqref{art9-lemma5.4-enum-1}\quad \text{of}\quad \ref{art9-lemma-5.4}\quad \text{holds}\\
(\tau_{0}, \tau_{1}, \varphi_{2}, \tau_{3}), & \text{if}\quad \eqref{art9-lemma5.4-enum-2}\quad \text{of}\quad \ref{art9-lemma-5.4}\quad \text{holds}\\
(\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}) & \text{if}\quad \eqref{art9-lemma5.4-enum-3}\quad \text{of}\quad \ref{art9-lemma-5.4}\quad \text{holds}
\end{cases}\\
\underline{n}' &=
\begin{cases}
(r', q',p')  & \text{if}\quad \eqref{art9-lemma5.4-enum-1}\quad \text{of}\quad \ref{art9-lemma-5.4}\quad \text{holds}\\
(q'-r',r',p'), & \text{if}\quad \eqref{art9-lemma5.4-enum-2}\quad \text{of}\quad \ref{art9-lemma-5.4}\quad \text{holds}\\
(q'-r', p'+r',r')& \text{if}\quad \eqref{art9-lemma5.4-enum-3}\quad \text{of}\quad \ref{art9-lemma-5.4}\quad \text{holds}
\end{cases}
\end{align*}

\item Let $\frac{r'}{n} = \frac{q'-r'}{m}\neq \frac{p'}{m}$. We set\label{art9-subsec5.5-enum-b}
$$
\underline{c}' = (\tau_{0}, \varphi_{1}, \varphi_{2}, \tau_{3}), \underline{n}'= (r',q', p')
$$
(the discussion being as in \ref{art9-subsec-5.2} \eqref{art9-subsec5.2-enum-b})

\item Let $\frac{r'}{n} = \frac{p'}{m} \neq \frac{q'-r'}{n}$ . We set\label{art9-subsec5.5-enum-c}
$$
\underline{c}' = (\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}), n' = (q'-r',p'+r', r')
$$

\item Let $\frac{p'}{m} = \frac{q'-r'}{m} \neq \frac{r'}{n}$. In this case, \eqref{art9-lemma5.4-enum-1}
of \ref{art9-lemma-5.4} cannot hold and \eqref{art9-lemma5.4-enum-1} and \eqref{art9-lemma5.4-enum-3} of \ref{art9-lemma-5.4} are mutually exclusive.\label{art9-subsec5.5-enum-d}

We set
\begin{align*}
\underline{c}'&=
\begin{cases}
(\tau_{0}, \varphi_{1}, \varphi_{2},\varphi_{3}), &\text{if}\quad \eqref{art9-lemma5.4-enum-1}\quad \text{of}\quad \ref{art9-lemma-5.4}\quad \text{holds}\\
(\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}), &\text{if}\quad \eqref{art9-lemma5.4-enum-3}\quad \text{of}\quad \ref{art9-lemma-5.4}\quad \text{holds}\\ 
\end{cases}
\end{align*}

\item Let $\frac{r'}{n} = \frac{p'}{m} = \frac{q'-r'}{m}$. This implies that $\frac{r'}{n} = \frac{p'+r'}{m+n} = \frac{q'}{m+n}$. Then all the three cases of \ref{art9-lemma-5.4} coincide and we set\label{art9-subsec5.5-enum-e}
$$
\underline{c}' = (\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}), \underline{n}' = (q'-r', p'+r',r')
$$
\end{enumerate}

\setcounter{equation}{5}
\begin{remark}\label{art9-remark-5.6}
In all of the cases \eqref{art9-subsec5.5-enum-a} through \eqref{art9-subsec5.5-enum-e} above, ($\underline{c}', \underline{n}'$) is of Type I, III or IV. Also if $y = (\overline{c',n'})$, the $y_{\min} = (\underline{c}', \underline{n}')$.
\end{remark}

\subsection{}\label{art9-subsec-5.7}
Let
\begin{align*}
L_{1} &= \{(p,q,r) \in L : r \geq m ,p + r \leq q \leq r+ n\}\\
L_{2} &=\{(p',q',r') \in L : r' \leq n, p' + r' \leq q' \leq r' +m \}
\end{align*}
An element $(p',q',r')$ in $L_{2}$ will be identified with the element $(p,q,r)$ in $L_{1}$, if $r' =p$, $p'=r$, $q' = q =r +p =r' +p'$. When this happens, we shall express it as $(p',q',r')\sim(p,q,r)$. Let $\theta$ be as in
\ref{art9-subsec-5.2} (resp. \ref{art9-subsec-5.5}). We observe that if $(p',q',r')\sim (p,q,r)$, then $\theta(p',q', r')= \theta(p,q,r)$. To see this, let $\theta(p,q,r) = (\underline{c},\underline{n})$, Then since $\frac{q-r}{n} = \frac{p}{n}$, only \eqref{art9-subsec5.5-enum-d} or \eqref{art9-subsec5.5-enum-e} of \ref{art9-subsec-5.2} can hold. If \eqref{art9-subsec5.5-enum-e} of \ref{art9-subsec-5.2} holds, then \eqref{art9-subsec5.5-enum-e} of \ref{art9-subsec-5.5} also holds. We have (\ref{art9-subsec-5.2} \eqref{art9-subsec5.5-enum-e}, \ref{art9-subsec-5.5} \eqref{art9-subsec5.5-enum-e}),
\begin{gather*}
\underline{c}= (\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}), \underline{n} = (r,q, p)\\
\underline{c}' = (\tau_{0}, \tau_{1}, \tau_{2}, \tau_{3}), \underline{n}' = (q'-r', p'+r',r')(=(r,q,p))
\end{gather*}
